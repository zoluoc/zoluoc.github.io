<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>zoluo</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://www.corkercode.com/"/>
  <updated>2019-01-27T16:13:40.678Z</updated>
  <id>https://www.corkercode.com/</id>
  
  <author>
    <name>zoluo</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Redis5.x版本搭建高可用集群（HA）</title>
    <link href="https://www.corkercode.com/2019/01/16/Redis5-x%E7%89%88%E6%9C%AC%E6%90%AD%E5%BB%BA%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%EF%BC%88HA%EF%BC%89/"/>
    <id>https://www.corkercode.com/2019/01/16/Redis5-x版本搭建高可用集群（HA）/</id>
    <published>2019-01-16T15:21:30.000Z</published>
    <updated>2019-01-27T16:13:40.678Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/redis%20ha.png" alt=""></div><a id="more"></a><h3 id="单机环境搭建"><a href="#单机环境搭建" class="headerlink" title="单机环境搭建"></a>单机环境搭建</h3><blockquote><p>单机环境仅供我们平时开发和测试时使用，一般我们可能会在 Linux 或者 Windows 上部署，Windows版本的部署非常简单，首先在 GitHub 上下载 zip 包解压到指定位置，后执行下面的命令就成功的部署好了。下载地址 <a href="https://github.com/MicrosoftArchive/redis/releases" target="_blank" rel="noopener">Redis GitHub 下载地址</a></p></blockquote><!--more --><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">redis-server.exe redis.windows.config</span><br><span class="line">`</span><br></pre></td></tr></table></figure><p>运行成功如下图<br><img src="http://upload-images.jianshu.io/upload_images/7269465-e0b6c83daf237c6e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Windows Redis"></p><blockquote><p>Linux 版本安装如下</p></blockquote><p>1.主机名修改<br>hostnamectl –static set-hostname  redis1</p><p>2.安装gcc  yum install gcc<br>检查是否安装 gcc -v</p><p>3.下载 Redis gz 安装包<br>到 <a href="https://redis.io/download" target="_blank" rel="noopener">Redis 官网</a>下载安装包，也可使用一下命令直接下载到服务器<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-5.0.3.tar.gz  #远程下载</span><br></pre></td></tr></table></figure></p><p>下载完成后解压到 <strong>/usr/local</strong> 目录下<br>修改 <strong>/usr/local/redis-5.0.3/redis.conf</strong> 参数 daemonize 值改为 yes，使其后台运行，启动命令如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/redis-5.0.3/src/redis-server /usr/local/redis-5.0.3/redis.conf #指定配置文件</span><br></pre></td></tr></table></figure></p><p>4.验证单机环境</p><ul><li>验证启动是否成功   ps -ef | grep redis  </li><li>进入redis客户端   /usr/local/redis-5.0.3/src/redis-cli  </li><li>存数据 set name zoluo</li><li>取数据 get name</li><li>退出客户端  quit 或 Ctrl + C 或 exit</li><li>退出redis服务：<br>（1）pkill redis-server<br>（2）kill -9 进程号</li></ul><h3 id="高可用集群环境搭建"><a href="#高可用集群环境搭建" class="headerlink" title="高可用集群环境搭建"></a>高可用集群环境搭建</h3><h4 id="哨兵模式"><a href="#哨兵模式" class="headerlink" title="哨兵模式"></a>哨兵模式</h4><p>在 Redis3.0 以前的版本要实现集群一般是借助哨兵 sentinel 工具来监控master节点的状态， 如果 master 节点异常，则会做主从切换，将某一台 slave 作为 master，哨兵的配置略微复 杂，并且性能和高可用性等各方面表现一般，特别是在主从切换的瞬间存在访问瞬断的情 况，而且哨兵模式只有一个主节点对外提供服务，没法支持很高的并发，且单个主节点内存 也不宜设置得过大，否则会导致持久化文件过大，影响数据恢复或主从同步的效率。<br>参考：</p><ul><li><a href="https://blog.csdn.net/py_tamir/article/details/82555338" target="_blank" rel="noopener">Redis 中哨兵sentinel 机制、从宕机及恢复、主库宕机及恢复解决方案</a></li><li><a href="https://www.cnblogs.com/gdpuzxs/p/6659873.html" target="_blank" rel="noopener">redis哨兵模式</a><h4 id="高可用集群模式"><a href="#高可用集群模式" class="headerlink" title="高可用集群模式"></a>高可用集群模式</h4>1.概述<br>Redis 的集群主要是使用切片技术来搭建的，简单来说就是把所有KEY分散存放到不同的redis节点上（不要把鸡蛋都放在一个篮子里）。</li></ul><p>2.说明<br>Redis 集群是一个由多个主从节点群组成的分布式服务器群，它具有复制、高可用和分片特 性。Redis 集群不需要 sentinel 哨兵也能完成节点移除和故障转移的功能。需要将每个节点 设置成集群模式，这种集群模式没有中心节点，可水平扩展，据官方文档称可以线性扩展到 上万个节点(官方推荐不超过 1000 个节点)。Redis 集群的性能和高可用性均优于之前版本的 哨兵模式，且集群配置非常简单 。</p><p>3.集群基本原理<br>Redis 集群中内置了 16384 个槽位，当需要放置数据时，Redis 先对 KEY 使用 CRC16 算法计算出一个结果，然后把结果对 16384 求余数，这样每个 KEY 都会对应一个编号在 0-16383 之间的槽号码，Redis 会根据节点数量大致均等的原则将哈希槽映射到不同节点。比如有 3 个 Redis 节点，把 16384 分成 3 段，每个节点承担一段范围的哈希槽。在一个集群中16384个槽位必须同时在线否则集群就会失败。</p><p>优点是添加和移除节点非常容易。比如要新增一个节点，值需要从其他节点上移动一些槽位到新节点即可，如果要删除一个节点，那就把它拥有的槽位移动到其他节点，然后进行删除。上面这种移动过程不需要任何停机时间。</p><p>所有的 Redis 节点彼此互通</p><ul><li>节点的失败是通过集群中超过半数的节点检测失效才生效的</li><li>客户端与 Redis 节点直连，不需要中间的代理，客户端不需要连接集群所有节点，只需要连接任何一个可用的节点即可</li></ul><p>4.Redis 高可用集群搭建<br>Redis 集群需要至少要三个 master 节点，我们这里使用三台虚拟机搭建三个 master 节点，并且给每个 master 再搭建一个slave 节点，总共6个 Redis 节点，这里用三台机器部署6个 Redis 实例，<br>每台机器一主一从，搭建集群的步骤如下：</p><p>第一步：在每台机器的 /usr/local 下创建文件夹 <strong>redis-cluster</strong>，然后在其下面分别创建 2 个文件夹如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$redis1</span><br><span class="line">mkdir -p /usr/local/redis-cluster  </span><br><span class="line">mkdir 7001</span><br><span class="line">mkdir 7002 </span><br><span class="line">$redis2</span><br><span class="line">mkdir -p /usr/local/redis-cluster  </span><br><span class="line">mkdir 7003</span><br><span class="line">mkdir 7004 </span><br><span class="line">$redis3</span><br><span class="line">mkdir -p /usr/local/redis-cluster  </span><br><span class="line">mkdir 7005</span><br><span class="line">mkdir 7006</span><br></pre></td></tr></table></figure></p><p>第二步：把之前的 /usr/local/redis-5.0.3/redis.conf 配置文件 copy 到每个 700* 下，修改如下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">（1）daemonize yes  </span><br><span class="line">（2）port 7001 #分别对每个机器的端口号进行设置  </span><br><span class="line">（3）dir /usr/local/redis-cluster/7001/ #指定数据文件存放位置，必须要指定不同的目录位置，不然会丢失数据</span><br><span class="line">（4）cluster-enabled yes #启动集群模式 </span><br><span class="line">（5）cluster-config-file nodes-7001.conf #集群节点信息文件，这里 700* 和port对应上  </span><br><span class="line">（6）cluster-node-timeout 5000   </span><br><span class="line">（7)  # bind 127.0.0.1 #去掉bind绑定访问ip信息</span><br><span class="line">（8) protected-mode  no  #关闭保护模式  </span><br><span class="line">（9）appendonly yes  #如果要设置密码需要增加如下配置： </span><br><span class="line">         requirepass zoluo  #设置redis访问密码</span><br><span class="line">         masterauth zoluo  #设置集群节点间访问密码，跟上面一致</span><br></pre></td></tr></table></figure></p><p>第三步：另外两台机器修改第2、3、5项里的端口号</p><p>第四步：分别启动6个redis实例，然后检查是否启动成功，命令如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/redis-5.0.3/src/redis-server /usr/local/redis-cluster/700*/redis.conf  </span><br><span class="line">ps -ef | grep redis #查看是否启动成功</span><br></pre></td></tr></table></figure></p><p>第五步：用 redis-cli 创建整个 Redis 集群(<strong>Redis 5.x以前的版本集群是依靠 ruby 脚本 redistrib.rb 实现</strong>)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/redis-5.0.3/src/redis-cli -a sinopec --cluster create --cluster-replicas 1 10.18.2.156:7001 10.18.2.160:7004 10.18.2.160:7003 10.18.2.187:7006 10.18.2.187:7005 10.18.2.156:7002 192.168.0.63:8006 #代表为每个创建的主服务器节点创建一个从服务器节点</span><br></pre></td></tr></table></figure></p><p><img src="http://upload-images.jianshu.io/upload_images/7269465-48e11219eb7bc74b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="加入集群"><br>第六步：验证集群：<br>（1）连接任意一个客户端即可：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#./redis-cli -c -h -p (-a访问服务端密码，-c表示集群模 式，指定ip地址和端口号）</span><br><span class="line">/usr/local/redis-5.0.3/src/redis-cli -a zoluo-c -h  10.18.2.160 -p 700*  </span><br><span class="line">cluster infoc #查看集群信息</span><br><span class="line">cluster nodes #查看节点列表 </span><br><span class="line">#进行数据操作验证</span><br></pre></td></tr></table></figure></p><p><img src="http://upload-images.jianshu.io/upload_images/7269465-7e1e0fe8a15432b7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="节点信息"><br>（2）关闭集群则需要逐个进行关闭，使用命令：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/redis-5.0.3/src/redis-cli -a zoluo -c -h 10.18.2.160 -p 700* shutdown</span><br></pre></td></tr></table></figure></p><p>自此 Redis 高可用集群搭建完毕！参考：<br><a href="https://www.cnblogs.com/yunxizhujing/articles/9750670.html" target="_blank" rel="noopener">Redis 集群详解</a><br><a href="https://redis.io/commands/cluster-nodes" target="_blank" rel="noopener">Redis 官方说明</a></p><h5 id="补充说明"><a href="#补充说明" class="headerlink" title="补充说明"></a>补充说明</h5><p>1.Redis 集群节点加入顺序与主节点与从节点关联是随机的，参考官方说明。<br>2.如果在安装过程中出现不可逆转的错误或安装失败，最好重新安装。<br>重新安装我要做关键的两步：</p><ul><li><p>关闭集群</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/redis-5.0.3/src/redis-cli -a zoluo -c -h 10.18.2.160 -p 700* shutdown</span><br><span class="line">或</span><br><span class="line">kill -9 进程号</span><br></pre></td></tr></table></figure></li><li><p>删除每台机器上数据文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/redis-cluster/700*/</span><br><span class="line">rm -rf appendonly.700*.aof</span><br><span class="line">rm -rf nodes.700*.conf</span><br></pre></td></tr></table></figure></li><li><p>重复操作上面 4、5、6 步骤，当然如果需要修改端口，按照每台机器不重复修改就行了。</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/redis%20ha.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="高可用架构" scheme="https://www.corkercode.com/categories/%E9%AB%98%E5%8F%AF%E7%94%A8%E6%9E%B6%E6%9E%84/"/>
    
    
      <category term="redis" scheme="https://www.corkercode.com/tags/redis/"/>
    
  </entry>
  
  <entry>
    <title>Docker Harbor私有仓库搭建</title>
    <link href="https://www.corkercode.com/2018/12/14/Docker-Harbor%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E6%90%AD%E5%BB%BA/"/>
    <id>https://www.corkercode.com/2018/12/14/Docker-Harbor私有仓库搭建/</id>
    <published>2018-12-14T09:32:37.000Z</published>
    <updated>2019-01-27T16:14:47.686Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/docker%20harbor.png" alt=""></div><a id="more"></a><h1 id="系统环境准备"><a href="#系统环境准备" class="headerlink" title="系统环境准备"></a>系统环境准备</h1><p>CentOS Linux release 7.4.1708 (Core)<br>docker version：1.13.1<br>docker-compose version 1.21.1, build 5a3f1a3<br>docker-py version: 3.3.0<br>CPython version: 3.6.5<br>OpenSSL version: OpenSSL 1.0.1t  3 May 2016<br>修改主机名，建议修改成 reg.yourdomain.com</p><h1 id="docker安装"><a href="#docker安装" class="headerlink" title="docker安装"></a>docker安装</h1><p>安装命令：# yum install docker -y<br>开启docker服务：# systemctl start docker<br>设置docker开启自启动：# chkconfig docker on<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># vim /usr/lib/systemd/system/docker.service</span><br><span class="line">  ExecStart=/usr/bin/dockerd-current --insecure-registry reg.cheng.com \</span><br></pre></td></tr></table></figure></p><p>重启docker： systemctl daemon-reload &amp;&amp; systemctl restart docker</p><h1 id="docker-compose安装"><a href="#docker-compose安装" class="headerlink" title="docker-compose安装"></a>docker-compose安装</h1><p>下载Docker Compose二进制可执行文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># curl -L https://github.com/docker/compose/releases/download/1.21.1/docker-compose-$(uname -s)-$(uname -m) -o /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure></p><p>添加可执行权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure></p><h1 id="OpenSSL安装"><a href="#OpenSSL安装" class="headerlink" title="OpenSSL安装"></a>OpenSSL安装</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># yum -y install openssl openssl-devel</span><br></pre></td></tr></table></figure><h1 id="下载harbor离线安装文件"><a href="#下载harbor离线安装文件" class="headerlink" title="下载harbor离线安装文件"></a>下载harbor离线安装文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># wget https://storage.googleapis.com/harbor-releases/release-1.5.0/harbor-offline-installer-v1.5.0.tgz</span><br><span class="line"># tar zxf harbor-offline-installer-v1.5.0.tgz -C /opt</span><br></pre></td></tr></table></figure><h1 id="证书安装"><a href="#证书安装" class="headerlink" title="证书安装"></a>证书安装</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># openssl req \ -newkey rsa:4096 -nodes -sha256 -keyout ca.key \ -x509 -days 365 -out ca.crt</span><br><span class="line"># openssl req \ -newkey rsa:4096 -nodes -sha256 -keyout yourdomain.com.key \ -out yourdomain.com.csr</span><br><span class="line"># openssl x509 -req -days 365 -in yourdomain.com.csr -CA ca.crt -CAkey ca.key -CAcreateserial -out yourdomain.com.crt</span><br><span class="line"># cp yourdomain.com.crt /root/cert/</span><br><span class="line"># cp yourdomain.com.key /root/cert/</span><br><span class="line"># cp ca.crt /etc/docker/certs.d/reg.yourdomain.com</span><br><span class="line"># cp yourdomain.com.crt /etc/pki/ca-trust/source/anchors/reg.yourdomain.com.crt</span><br><span class="line"># update-ca-trust</span><br></pre></td></tr></table></figure><h1 id="配置harbor-cfg文件"><a href="#配置harbor-cfg文件" class="headerlink" title="配置harbor.cfg文件"></a>配置harbor.cfg文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">hostname： reg.yourdomain.com</span><br><span class="line">ui_url_protocol: http or https(我这边使用https，如果使用http后面证书部分可以忽略)</span><br><span class="line">db_password = password（mysql数据库密码）</span><br><span class="line">ssl_cert = /root/cert/yourdomain.com.crt</span><br><span class="line">ssl_cert_key = /root/cert/yourdomain.com.key</span><br></pre></td></tr></table></figure><p>启动harbor<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># cd /opt/harbor</span><br><span class="line"># ./prepare</span><br><span class="line"># ./install.sh</span><br></pre></td></tr></table></figure></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@cheng harbor]# docker ps</span><br><span class="line">CONTAINER ID        IMAGE                                  COMMAND                  CREATED             STATUS                    PORTS                                                              NAMES</span><br><span class="line">146f85e00e03        vmware/nginx-photon:v1.5.0             &quot;nginx -g &apos;daemon ...&quot;   4 hours ago         Up 33 minutes (healthy)   0.0.0.0:80-&gt;80/tcp, 0.0.0.0:443-&gt;443/tcp, 0.0.0.0:4443-&gt;4443/tcp   nginx</span><br><span class="line">80983c6fab8a        vmware/harbor-jobservice:v1.5.0        &quot;/harbor/start.sh&quot;       4 hours ago         Up 33 minutes                                                                                harbor-jobservice</span><br><span class="line">f1b10ff3b2f3        vmware/harbor-ui:v1.5.0                &quot;/harbor/start.sh&quot;       4 hours ago         Up 33 minutes (healthy)                                                                      harbor-ui</span><br><span class="line">0eab9eef6442        vmware/harbor-db:v1.5.0                &quot;/usr/local/bin/do...&quot;   4 hours ago         Up 33 minutes (healthy)   3306/tcp                                                           harbor-db</span><br><span class="line">50ad985dda9b        vmware/harbor-adminserver:v1.5.0       &quot;/harbor/start.sh&quot;       4 hours ago         Up 33 minutes (healthy)                                                                      harbor-adminserver</span><br><span class="line">827a0883f325        vmware/registry-photon:v2.6.2-v1.5.0   &quot;/entrypoint.sh se...&quot;   4 hours ago         Up 33 minutes (healthy)   5000/tcp                                                           registry</span><br><span class="line">a4c156cfe376        vmware/redis-photon:v1.5.0             &quot;docker-entrypoint...&quot;   4 hours ago         Up 33 minutes             6379/tcp                                                           redis</span><br><span class="line">acb2adc81be9        vmware/harbor-log:v1.5.0               &quot;/bin/sh -c /usr/l...&quot;   4 hours ago         Up 33 minutes (healthy)   127.0.0.1:1514-&gt;10514/tcp                                          harbor-log</span><br></pre></td></tr></table></figure><p>启动成功！</p><h1 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h1><p>页面访问：<a href="https://132.232.103.84" target="_blank" rel="noopener"></a> 登录用户名admin，默认密码Harbor12345<br>[图片上传失败…(image-cff177-1539240618559)]</p><p>docker登录：docker login reg.cheng.com ；然后就可以上传下载镜像了。<br>docker tag SOURCE_IMAGE[:TAG] reg.cheng.com/myproject/IMAGE[:TAG]<br>docker push reg.cheng.com/myproject/IMAGE[:TAG]<br>注：<br>    如果修改配置文件需要重新执行./prepare脚本重新生成配置，再重建容器！ docker-compose up -d<br>    对于其他节点来说，需要先拷贝ca证书到每个计算节点，然后执行cp ca.crt /etc/docker/certs.d/reg.yourdomain.com，这样才能做证书验证。</p><p>注：修改docker配置后需要重启harbor<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># systemctl restart docker</span><br><span class="line"># docker-compose stop</span><br><span class="line"># docker-compose start</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/docker%20harbor.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Kubernetes" scheme="https://www.corkercode.com/categories/Kubernetes/"/>
    
    
      <category term="kubernetes" scheme="https://www.corkercode.com/tags/kubernetes/"/>
    
      <category term="docker" scheme="https://www.corkercode.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>Kubernetes+Docker+SVN+Jenkins+Maven DevOps</title>
    <link href="https://www.corkercode.com/2018/12/14/Kubernetes-Docker-SVN-Jenkins-Maven-DevOps/"/>
    <id>https://www.corkercode.com/2018/12/14/Kubernetes-Docker-SVN-Jenkins-Maven-DevOps/</id>
    <published>2018-12-14T09:32:37.000Z</published>
    <updated>2019-01-27T16:16:18.981Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="https://upload-images.jianshu.io/upload_images/7269465-b1cfddb982c10301.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="流程图"></div><a id="more"></a><p><strong>随着分布式开发和微服务的大量引进，应用测试、发布到上线成为了项目的一大痛点，我们不得不考虑自动化平台的搭建既使用。通过查找相关文档，得到证实DevOps（Development和Operations的组合词）是目前最好的实践方式，对CI/CD的诠释也相对完整。下图直观表现了一体化思维，从项目源码到应用上线部署只需一个按钮搞定，本文是由自己搭建所有组件并成功演示了一键打包部署（项目打包、镜像生成、服务编排）.</strong></p><blockquote><p>流程结构流程说明：<br>1、用户向Gitlab或SVN提交代码，代码中包含Dockerfile文件；<br>2、Jenkins监听代码库的推送和变更事件；<br>3、Jenkins调用Maven插件对源码进行编译打包；<br>4、Jenkins调用docker工具根据Dockerfile文件生成镜像，并推送镜像至Harbor仓库；<br>5、Jenkins通过SSH远程调用Kubernetes集群的Master节点，更新Pod的的模板yaml文件，调用kubectl命令进行发布操作；<br>6、Kubernetes集群的Node节点从Harbor仓库拉取镜像，启动Pod和应用容器。</p></blockquote><h1 id="实施步骤"><a href="#实施步骤" class="headerlink" title="实施步骤"></a>实施步骤</h1><h2 id="kubernets测试机或高可用集群环境搭建-已完成"><a href="#kubernets测试机或高可用集群环境搭建-已完成" class="headerlink" title="kubernets测试机或高可用集群环境搭建        已完成"></a>kubernets测试机或高可用集群环境搭建        已完成</h2><h2 id="docker-harbor私有仓库搭建-已完成"><a href="#docker-harbor私有仓库搭建-已完成" class="headerlink" title="docker harbor私有仓库搭建        已完成"></a>docker harbor私有仓库搭建        已完成</h2><h2 id="kubernets-harbor-docker-svn-Jenkins-maven代码持续集成与自动部署"><a href="#kubernets-harbor-docker-svn-Jenkins-maven代码持续集成与自动部署" class="headerlink" title="kubernets+harbor+docker+svn+Jenkins+maven代码持续集成与自动部署"></a>kubernets+harbor+docker+svn+Jenkins+maven代码持续集成与自动部署</h2><h3 id="jdk和maven安装"><a href="#jdk和maven安装" class="headerlink" title="jdk和maven安装"></a>jdk和maven安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># tar -zxvf jdk-8u144-linux-x64.tar.gz -C /usr/local</span><br><span class="line"># tar -zxvf apache-maven-3.5.4-bin.tar.gz -C /usr/local</span><br></pre></td></tr></table></figure><p>配置环境变量：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#set java enviroment</span><br><span class="line">JAVA_HOME=/usr/local/jdk1.8.0_152</span><br><span class="line">JRE_HOME=/usr/local/jdk1.8.0_152/jre</span><br><span class="line">CLASS_PATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib</span><br><span class="line">PATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin</span><br><span class="line">export JAVA_HOME JRE_HOME CLASS_PATH PATH</span><br><span class="line">#set maven enviroment</span><br><span class="line">export MAVEN_HOME=/usr/local/apache-maven-3.5.4</span><br><span class="line">export PATH=$MAVEN_HOME/bin:$PATH</span><br></pre></td></tr></table></figure></p><p>验证：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># java -version</span><br><span class="line"># mvn -v</span><br></pre></td></tr></table></figure></p><h3 id="SVN使用公司的"><a href="#SVN使用公司的" class="headerlink" title="SVN使用公司的"></a>SVN使用公司的</h3><h3 id="Jenkins安装"><a href="#Jenkins安装" class="headerlink" title="Jenkins安装"></a>Jenkins安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo</span><br><span class="line"># wget -q -O - http://pkg.jenkins.io/debian-stable/jenkins.io.key</span><br><span class="line"># sh -&apos;echo deb http://pkg.jenkins-ci.org/debian-stable binary/ &gt; /etc/apt/sources.list.d/jenkins.list&apos;</span><br><span class="line"># yum install jenkins</span><br><span class="line"># service jenkins restart</span><br><span class="line"># systemctl status jenkins.service</span><br><span class="line"># systemctl daemon-reload</span><br><span class="line"># service jenkins restart</span><br></pre></td></tr></table></figure><p>注意报错：Starting Jenkins bash: /usr/bin/java: No such file or directory<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># vim /etc/init.d/jenkins`</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/7269465-e2e8f832a5d6a09d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="报错一"><br><img src="https://upload-images.jianshu.io/upload_images/7269465-a3a1401a01c84d94.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="报错二"></p><p>修改java路径为自己安装的路径：/usr/local/jdk1.8.0_152/bin/java<br>Jenkins默认设置：<br>日志路径：/var/log/jenkins/jenkins.log<br>配置文件：/etc/sysconfig/jenkins<br>默认启用8080端口<br>Jenkins权限变更：<br>由于Jenkins需要执行shell脚本，为后续操作方便给Jenkins一个root权限<br>1、vim /etc/sysconfig/jenkins JENKINS_USER 改为root<br>2、更改相关目录权限<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chown –R root:root /var/lib/jenkins</span><br><span class="line">chown –R root:root /var/cache/jenkins</span><br><span class="line">chown –R root:root /var/log/jenkins</span><br></pre></td></tr></table></figure></p><p>3、重启Jenkins<br><code>service jenkins restart</code><br>需要/var/lib/jenkins/secrets/initialAdminPassword的密码解锁Jenkins<br><a href="https://www.cnblogs.com/apple2016/p/7763002.html" target="_blank" rel="noopener">Jenkins邮件通知设置参照：</a></p><p>插件安装选择默认建议安装，额外插件： Publish Over SSH、 docker-build-step、 Maven Integration plugin、 SSH Slaves plugin<br>Jenkins全局工具设置：<br>系统管理-&gt;全局工具配置<br><img src="https://upload-images.jianshu.io/upload_images/7269465-a3bb425fcc611cfa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="four.png"></p><hr><p><img src="https://upload-images.jianshu.io/upload_images/7269465-890beec781fb3add.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="five.png"><br>新建maven项目并配置<br><img src="https://upload-images.jianshu.io/upload_images/7269465-bea8d4490db9c568.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="six.png"></p><hr><p><img src="https://upload-images.jianshu.io/upload_images/7269465-eb15f93b1928090b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="siven.png"></p><hr><p><img src="https://upload-images.jianshu.io/upload_images/7269465-42fba6a1a39bd6e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="eight.png"></p><hr><p><img src="https://upload-images.jianshu.io/upload_images/7269465-9af0e767c66611a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nine.png"></p><hr><p><img src="https://upload-images.jianshu.io/upload_images/7269465-c41e49247ca8c223.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="ten.png"><br>至此，一键部署应用到kubernetes集群就完成了！</p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;https://upload-images.jianshu.io/upload_images/7269465-b1cfddb982c10301.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240&quot; alt=&quot;流程图&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Kubernetes" scheme="https://www.corkercode.com/categories/Kubernetes/"/>
    
    
      <category term="kubernetes" scheme="https://www.corkercode.com/tags/kubernetes/"/>
    
      <category term="docker" scheme="https://www.corkercode.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>k8s 命令总结</title>
    <link href="https://www.corkercode.com/2018/12/14/k8s-%E5%91%BD%E4%BB%A4%E6%80%BB%E7%BB%93/"/>
    <id>https://www.corkercode.com/2018/12/14/k8s-命令总结/</id>
    <published>2018-12-14T09:32:37.000Z</published>
    <updated>2019-01-27T16:16:24.287Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/Kubernetes.jpg" alt=""></div><a id="more"></a><h1 id="Kubernetes-常用安装和使用命令总结"><a href="#Kubernetes-常用安装和使用命令总结" class="headerlink" title="Kubernetes 常用安装和使用命令总结"></a>Kubernetes 常用安装和使用命令总结</h1><ul><li>获取所有命名空间上的pod<br><code>kubectl get pod  -o wide  --all-namespaces</code></li><li>查看pod IP时使用<br><code>kubectl get services</code></li><li><p>查看dsecp-sso-server-w5tx2 日志<br><code>kubectl describe --namespace=default po dsecp-sso-server-w5tx2</code></p><!--more--></li><li><p>通过yaml文件创建：<br><code>kubectl create -f xxx.yaml</code> （不建议使用，无法更新，必须先delete）<br><code>kubectl apply -f xxx.yaml</code>（创建+更新，可以重复使用）</p></li><li><p>通过yaml文件删除：<br><code>kubectl delete -f xxx.yaml</code></p></li><li><p>查看kube-system namespace下面的pod/svc/deployment 等等（-o wide  选项可以查看存在哪个对应的节点）<br><code>kubectl get pod/svc/deployment -n kube-system</code></p></li><li><p>查看所有namespace下面的pod/svc/deployment等等<br><code>kubectl get pod/svc/deployment --all-namcpaces</code></p></li><li><p>重启pod（无法删除对应的应用，因为存在deployment/rc之类的副本控制器，删除pod也会重新拉起来）<br><code>kubectl get pod -n kube-system</code></p></li><li><p>查看pod描述：<br><code>kubectl describe pod XXX -n kube-system</code></p></li><li><p>查看pod 日志 （如果pod有多个容器需要加-c 容器名）<br><code>kubectl logs xxx -n kube-system</code></p></li><li><p>删除应用（先确定是由说明创建的，再删除对应的kind）：<br><code>kubectl delete deployment xxx -n kube-system</code></p></li><li>根据label删除：<br><code>kubectl delete pod -l app=flannel -n kube-system</code></li><li>扩容<br><code>kubectl scale deployment spark-worker-deployment --replicas=8</code></li></ul><h1 id="导出配置文件："><a href="#导出配置文件：" class="headerlink" title="导出配置文件："></a>导出配置文件：</h1><p>　　## 导出proxy<br>　　<code>kubectl get ds -n kube-system -l k8s-app=kube-proxy -o yaml&gt;kube-proxy-ds.yaml</code><br>　　## 导出kube-dns<br>   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">　　kubectl get deployment -n kube-system -l k8s-app=kube-dns -o yaml &gt;kube-dns-dp.yaml</span><br><span class="line">　　kubectl get services -n kube-system -l k8s-app=kube-dns -o yaml &gt;kube-dns-services.yaml</span><br></pre></td></tr></table></figure></p><p>　　## 导出所有 configmap<br>　　<code>kubectl get configmap -n kube-system -o wide -o yaml &gt; configmap.yaml</code></p><h2 id="复杂操作命令："><a href="#复杂操作命令：" class="headerlink" title="复杂操作命令："></a>复杂操作命令：</h2><p>　　### 删除kube-system 下Evicted状态的所有pod：<br>　　<code>kubectl get pods -n kube-system |grep Evicted| awk &#39;{print $1}&#39;|xargs kubectl delete pod  -n kube-system</code></p><h1 id="以下为维护环境相关命令："><a href="#以下为维护环境相关命令：" class="headerlink" title="以下为维护环境相关命令："></a>以下为维护环境相关命令：</h1><ul><li><p>重启kubelet服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart kubelet</span><br></pre></td></tr></table></figure></li><li><p>修改启动参数<br><code>vim /etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code></p></li><li>查看集群信息<br><code>kubectl cluster-info</code></li><li>查看各组件信息<br><code>kubectl get componentstatuses</code></li><li>查看kubelet进程启动参数<br><code>ps -ef | grep kubelet</code></li><li>查看日志:<br><code>journalctl -u kubelet -f</code></li><li>设为不可调度状态：<br><code>kubectl cordon node1</code></li><li>将pod赶到其他节点：<br><code>kubectl drain node1</code></li><li>解除不可调度状态<br><code>kubectl uncordon node1</code></li><li>master运行pod<br><code>kubectl taint nodes master.k8s node-role.kubernetes.io/master-</code></li><li>master不运行pod<br><code>kubectl taint nodes master.k8s node-role.kubernetes.io/master=:NoSchedule</code></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/Kubernetes.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Kubernetes" scheme="https://www.corkercode.com/categories/Kubernetes/"/>
    
    
      <category term="kubernetes" scheme="https://www.corkercode.com/tags/kubernetes/"/>
    
      <category term="docker" scheme="https://www.corkercode.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>kubernetes 重要概念</title>
    <link href="https://www.corkercode.com/2018/12/14/kubernetes-%E9%87%8D%E8%A6%81%E6%A6%82%E5%BF%B5/"/>
    <id>https://www.corkercode.com/2018/12/14/kubernetes-重要概念/</id>
    <published>2018-12-14T09:32:37.000Z</published>
    <updated>2019-01-27T16:16:12.381Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/what%20is%20kubernetes.jpg" alt=""></div><a id="more"></a><blockquote><p>在实践之前，我们必须了解一下kubernets的几个重要概念，它们是组成kubernets集群的基石。</p></blockquote><h3 id="Cluster"><a href="#Cluster" class="headerlink" title="Cluster"></a>Cluster</h3><p>Cluster 是计算、存储和网络资源的集合，Kubernetes 利用这些资源运行各种基于容器的应用。</p><h3 id="Master"><a href="#Master" class="headerlink" title="Master"></a>Master</h3><p>Master 是 Cluster 的大脑，它的主要职责是调度，即决定将应用放在哪里运行。Master 运行 Linux 操作系统，可以是物理机或者虚拟机。为了实现高可用，可以运行多个 Master。</p><h3 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h3><p>Node 的职责是运行容器应用。Node 由 Master 管理，Node 负责监控并汇报容器的状态，并根据 Master 的要求管理容器的生命周期。Node 运行在 Linux 操作系统，可以是物理机或者是虚拟机。</p><p>在前面交互式教程中我们创建的 Cluster 只有一个主机 host01，它既是 Master 也是 Node。</p><h3 id="Pod"><a href="#Pod" class="headerlink" title="Pod"></a>Pod</h3><p>Pod是kubernets的最小工作单元。每个pod包含一个或多个容器。pod中的容器会做为一个整体被master调度到一个node上运行。</p><h3 id="kubernets引入pod主要基于下面两个目的："><a href="#kubernets引入pod主要基于下面两个目的：" class="headerlink" title="kubernets引入pod主要基于下面两个目的："></a>kubernets引入pod主要基于下面两个目的：</h3><ol><li><p>可管理性</p><p>有些容器天生就是需要紧密联系，一起工作。Pod提供了比容器更高层次的抽象，将它们封装到一个部署单元中。Kubernetes以Pod为最小单元进行调度、扩展、资源共享、管理生命周期。</p></li><li><p>通信和资源共享</p><p>Pod中所有容器使用同一个网络namespace，即相同的IP地址和Port空间。它们可以直接使用localhost进行通信。同样的，这些容器可以共享存储，当kubernets挂在volume到pod，本质上是将volume挂在到pod中的每一个容器。</p></li></ol><h3 id="Pod有两种使用方式："><a href="#Pod有两种使用方式：" class="headerlink" title="Pod有两种使用方式："></a>Pod有两种使用方式：</h3><ol><li><p>运行单一容器</p><p>one-container-per-Pod 是 Kubernetes 最常见的模型，这种情况下，只是将单个容器简单封装成 Pod。即便是只有一个容器，Kubernetes 管理的也是 Pod 而不是直接管理容器。</p></li><li><p>运行多个容器</p><p>但问题在于：哪些容器应该放到一个 Pod 中？ </p><p>答案是：这些容器联系必须 非常紧密，而且需要 直接共享资源。</p></li></ol><h3 id="Controller"><a href="#Controller" class="headerlink" title="Controller"></a>Controller</h3><p>Kubernetes 通常不会直接创建 Pod，而是通过 Controller 来管理 Pod 的。Controller 中定义了 Pod 的部署特性，比如有几个副本，在什么样的 Node 上运行等。为了满足不同的业务场景，Kubernetes 提供了多种 Controller，包括 Deployment、ReplicaSet、DaemonSet、StatefuleSet、Job 等，我们逐一讨论。</p><h3 id="Deployment"><a href="#Deployment" class="headerlink" title="Deployment"></a>Deployment</h3><p>是最常用的 Controller，比如前面在线教程中就是通过创建 Deployment 来部署应用的。Deployment 可以管理 Pod 的多个副本，并确保 Pod 按照期望的状态运行。</p><h3 id="ReplicaSet"><a href="#ReplicaSet" class="headerlink" title="ReplicaSet"></a>ReplicaSet</h3><p>实现了 Pod 的多副本管理。使用 Deployment 时会自动创建 ReplicaSet，也就是说 Deployment 是通过 ReplicaSet 来管理 Pod 的多个副本，我们通常不需要直接使用 ReplicaSet。</p><h3 id="DaemonSet"><a href="#DaemonSet" class="headerlink" title="DaemonSet"></a>DaemonSet</h3><p>用于每个 Node 最多只运行一个 Pod 副本的场景。正如其名称所揭示的，DaemonSet 通常用于运行 daemon。</p><h3 id="StatefuleSet"><a href="#StatefuleSet" class="headerlink" title="StatefuleSet"></a>StatefuleSet</h3><p>能够保证 Pod 的每个副本在整个生命周期中名称是不变的。而其他 Controller 不提供这个功能，当某个 Pod 发生故障需要删除并重新启动时，Pod 的名称会发生变化。同时 StatefuleSet 会保证副本按照固定的顺序启动、更新或者删除。</p><h3 id="Job"><a href="#Job" class="headerlink" title="Job"></a>Job</h3><p>用于运行结束就删除的应用。而其他 Controller 中的 Pod 通常是长期持续运行。</p><h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><p>Deployment 可以部署多个副本，每个 Pod 都有自己的 IP，外界如何访问这些副本呢？</p><p>通过 Pod 的 IP 吗？</p><p>要知道 Pod 很可能会被频繁地销毁和重启，它们的 IP 会发生变化，用 IP 来访问不太现实。</p><p>答案是 Service。</p><p>Kubernetes Service 定义了外界访问一组特定 Pod 的方式。Service 有自己的 IP 和端口，Service 为 Pod 提供了负载均衡。</p><p>Kubernetes 运行容器（Pod）与访问容器（Pod）这两项任务分别由 Controller 和 Service 执行。</p><h3 id="Namespace"><a href="#Namespace" class="headerlink" title="Namespace"></a>Namespace</h3><p>如果有多个用户或项目组使用同一个 Kubernetes Cluster，如何将他们创建的 Controller、Pod 等资源分开呢？</p><p>答案就是 Namespace。</p><p>Namespace 可以将一个物理的 Cluster 逻辑上划分成多个虚拟 Cluster，每个 Cluster 就是一个 Namespace。不同 Namespace 里的资源是完全隔离的。</p><p>Kubernetes 默认创建了两个 Namespace。</p><p>[图片上传失败…(image-be4556-1547737146536)]</p><p><img src="https://upload-images.jianshu.io/upload_images/7269465-7e43905aef41cfda.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"> </p><p>default – 创建资源时如果不指定，将被放到这个 Namespace 中。</p><p>kube-system – Kubernetes 自己创建的系统资源将放到这个 Namespace 中。</p><p>熟悉了 k8s 的这些重要概念，下节开始，我们将搭建自己的 Kubernetes 集群。</p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/what%20is%20kubernetes.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Kubernetes" scheme="https://www.corkercode.com/categories/Kubernetes/"/>
    
    
      <category term="kubernetes" scheme="https://www.corkercode.com/tags/kubernetes/"/>
    
      <category term="docker" scheme="https://www.corkercode.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>k8s 测试 dns</title>
    <link href="https://www.corkercode.com/2018/12/14/k8s-%E6%B5%8B%E8%AF%95-dns/"/>
    <id>https://www.corkercode.com/2018/12/14/k8s-测试-dns/</id>
    <published>2018-12-14T09:32:37.000Z</published>
    <updated>2019-01-27T16:16:30.258Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/Kubernetes-Service---Blog-Header.png" alt=""></div><a id="more"></a><p>前面我们已经搭建好环境，现在需要测试一下dns是否可用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl run curl --image=radial/busyboxplus:curl -i --ttyWaiting for pod default/curl-2421989462-3xx4j to be running, status is Pending, pod ready: falseWaiting for pod default/curl-2421989462-3xx4j to be running, status is Pending, pod ready: falseWaiting for pod default/curl-2421989462-3xx4j to be running, status is Pending, pod ready: falseWaiting for pod default/curl-2421989462-3xx4j to be running, status is Pending, pod ready: false</span><br></pre></td></tr></table></figure></p><p>进入后执行nslookup kubernetes.default确认解析正常。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[ root@curl-2421989462-3xx4j:/ ]$ nslookup kubernetes.defaultServer: 10.96.0.10</span><br><span class="line">Address 1: 10.96.0.10 kube-dns.kube-system.svc.cluster.local</span><br><span class="line"></span><br><span class="line">Name: kubernetes.default</span><br><span class="line">Address 1: 10.96.0.1 kubernetes.default.svc.cluster.local</span><br></pre></td></tr></table></figure><p>测试OK后，删除掉curl这个Pod。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete deploy curl`</span><br></pre></td></tr></table></figure></p><p>到这一步就可以向集群中发布微服务了，同时可以使用kubeadm join命令添加新的Node到集群中</p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/Kubernetes-Service---Blog-Header.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Kubernetes" scheme="https://www.corkercode.com/categories/Kubernetes/"/>
    
    
      <category term="kubernetes" scheme="https://www.corkercode.com/tags/kubernetes/"/>
    
      <category term="docker" scheme="https://www.corkercode.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>基于 kubeadm 的 kubernetes 高可用集群部署&lt;-&gt;</title>
    <link href="https://www.corkercode.com/2018/12/14/%E5%9F%BA%E4%BA%8E-kubeadm-%E7%9A%84-kubernetes-%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2-%E4%B8%80/"/>
    <id>https://www.corkercode.com/2018/12/14/基于-kubeadm-的-kubernetes-高可用集群部署-一/</id>
    <published>2018-12-14T09:32:37.000Z</published>
    <updated>2019-01-27T16:15:34.399Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/play%20with%20kubernetes.png" alt=""></div><a id="more"></a><h3 id="部署概要说明"><a href="#部署概要说明" class="headerlink" title="部署概要说明"></a>部署概要说明</h3><p>kubernetes高可用的核心架构是master的高可用，kubectl、客户端以及nodes访问load balancer实现高可用。</p><h3 id="详细部署架构图："><a href="#详细部署架构图：" class="headerlink" title="详细部署架构图："></a>详细部署架构图：</h3><p><img src="http://upload-images.jianshu.io/upload_images/7269465-f07c7f13a1db269a?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p><h3 id="kubernetes组件说明"><a href="#kubernetes组件说明" class="headerlink" title="kubernetes组件说明"></a>kubernetes组件说明</h3><p>1.kube-apiserver：集群核心，集群API接口、集群各个组件通信的中枢；集群安全控制；</p><p>2.etcd：集群的数据中心，用于存放集群的配置以及状态信息，非常重要，如果数据丢失那么集群将无法恢复；因此高可用集群部署首先就是etcd是高可用集群；</p><p>3.kube-scheduler：集群Pod的调度中心；默认kubeadm安装情况下–leader-elect参数已经设置为true，保证master集群中只有一个kube-scheduler处于活跃状态；</p><p>4.kube-controller-manager：集群状态管理器，当集群状态与期望不同时，kcm会努力让集群恢复期望状态，比如：当一个pod死掉，kcm会努力新建一个pod来恢复对应replicas set期望的状态；默认kubeadm安装情况下–leader-elect参数已经设置为true，保证master集群中只有一个kube-controller-manager处于活跃状态；</p><p>5.kubelet: kubernetes node agent，负责与node上的docker engine打交道；</p><p>6.kube-proxy: 每个node上一个，负责service vip到endpoint pod的流量转发，当前主要通过设置iptables规则实现。</p><h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><p>keepalived集群设置一个虚拟ip地址，虚拟ip地址指向k8s-master1、k8s-master2、k8s-master3。<br>nginx用于k8s-master1、k8s-master2、k8s-master3的apiserver的负载均衡。外部kubectl以及nodes访问apiserver的时候就可以用过keepalived的虚拟ip(172.24.12.80)以及nginx端口(8443)访问master集群的apiserver。</p><h3 id="部署安装"><a href="#部署安装" class="headerlink" title="部署安装"></a>部署安装</h3><h4 id="主节点安装清单"><a href="#主节点安装清单" class="headerlink" title="主节点安装清单"></a>主节点安装清单</h4><table><thead><tr><th>主机名</th><th>IP地址</th><th>说明</th><th>安装组件</th></tr></thead><tbody><tr><td>K8s-master1</td><td>172.24.12.32</td><td>master节点1</td><td>keepalived、nginx、etcd、kubelet、kube-apiserver、kube-scheduler、kube-proxy、kube-dashboard、heapster、docker</td></tr><tr><td>K8s-master2</td><td>172.24.12.33</td><td>master节点2</td><td>keepalived、nginx、etcd、kubelet、kube-apiserver、kube-scheduler、kube-proxy、kube-dashboard、heapster、docker</td></tr><tr><td>K8s-master3</td><td>172.24.12.34</td><td>master节点3</td><td>keepalived、nginx、etcd、kubelet、kube-apiserver、kube-scheduler、kube-proxy、kube-dashboard、heapster、docker</td></tr><tr><td>无</td><td>172.24.12.80</td><td>keepalived虚拟IP</td><td>无</td></tr><tr><td>K8s-node1~</td><td>172.24.12.35~</td><td>node节点</td><td>kubelet、kube-proxy、docker</td></tr></tbody></table><h4 id="安装前准备"><a href="#安装前准备" class="headerlink" title="安装前准备"></a>安装前准备</h4><h5 id="版本信息"><a href="#版本信息" class="headerlink" title="版本信息"></a>版本信息</h5><ul><li><p>linux版本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# cat /etc/redhat-release</span><br><span class="line">                         CentOS Linux release 7.5.1804 (Core)</span><br></pre></td></tr></table></figure></li><li><p>docker版本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# docker version</span><br><span class="line">                  Client:</span><br><span class="line">                  Version:         1.13.1</span><br><span class="line">                  API version:     1.26</span><br><span class="line">                  Package version: docker-1.13.1-63.git94f4240.el7.centos.x86_64</span><br><span class="line">                  Go version:      go1.9.4</span><br><span class="line">                  Git commit:      94f4240/1.13.1</span><br><span class="line">                  Built:           Fri May 18 15:44:33 2018</span><br><span class="line">                  OS/Arch:         linux/amd64</span><br><span class="line">                   </span><br><span class="line">                  Server:</span><br><span class="line">                  Version:         1.13.1</span><br><span class="line">                  API version:     1.26 (minimum version 1.12)</span><br><span class="line">                  Package version: docker-1.13.1-63.git94f4240.el7.centos.x86_64</span><br><span class="line">                  Go version:      go1.9.4</span><br><span class="line">                  Git commit:      94f4240/1.13.1</span><br><span class="line">                  Built:           Fri May 18 15:44:33 2018</span><br><span class="line">                  OS/Arch:         linux/amd64</span><br><span class="line">                  Experimental:    false</span><br></pre></td></tr></table></figure></li><li><p>kubeadm版本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1.10.3</span><br></pre></td></tr></table></figure></li><li><p>kubeletl版本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">v1.10.3</span><br></pre></td></tr></table></figure></li></ul><h5 id="docker镜像准备"><a href="#docker镜像准备" class="headerlink" title="docker镜像准备"></a>docker镜像准备</h5><ul><li><p>执行脚本：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">images=(kube-proxy-amd64:v1.10.3 kube-scheduler-amd64:v1.10.3 kube-controller-manager-amd64:v1.10.3 kube-apiserver-amd64:v1.10.3</span><br><span class="line">etcd-amd64:3.1.12 pause-amd64:3.1 kubernetes-dashboard-amd64:v1.8.3 k8s-dns-sidecar-amd64:1.14.8 k8s-dns-kube-dns-amd64:1.14.8</span><br><span class="line">k8s-dns-dnsmasq-nanny-amd64:1.14.8 heapster-amd64:v1.5.2)</span><br><span class="line">for imageName in $&#123;images[@]&#125; ; do</span><br><span class="line">  docker pull keveon/$imageName</span><br><span class="line">  docker tag keveon/$imageName k8s.gcr.io/$imageName</span><br><span class="line">  docker rmi keveon/$imageName</span><br><span class="line">done</span><br></pre></td></tr></table></figure></li><li><p>额外镜像</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx</span><br><span class="line">docker pull keveon/flannel:v0.9.1-amd64</span><br><span class="line">docker tag keveon/flannel:v0.9.1-amd64 quay.io/coreos/flannel:v0.9.1-amd64</span><br></pre></td></tr></table></figure></li></ul><h5 id="系统设置"><a href="#系统设置" class="headerlink" title="系统设置"></a>系统设置</h5><p>以下在kubernetes所有节点上都是使用root用户进行操作：<br>1.在kubernetes所有节点上增加kubernetes仓库：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span><br><span class="line"></span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure></p><p>2.在kubernetes所有节点上进行系统更新<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# yum update -y</span><br></pre></td></tr></table></figure></p><p>3.在kubernetes所有节点上关闭防火墙<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl disable firewalld &amp;&amp; systemctl stop firewalld &amp;&amp; systemctl status firewalld</span><br></pre></td></tr></table></figure></p><p>4.在kubernetes所有节点上设置SELINUX为permissive模式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/selinux/config</span><br><span class="line">SELINUX=permissive</span><br></pre></td></tr></table></figure></p><p>5.在kubernetes所有节点上设置iptables参数，否则kubeadm init会提示错误<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/sysctl.conf</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br></pre></td></tr></table></figure></p><p>6.关闭各节点swap<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swapoff -a #会关闭所有swap</span><br></pre></td></tr></table></figure></p><p>7.主机名修改<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostnamectl --static set-hostname  k8s-master1</span><br></pre></td></tr></table></figure></p><p>8.在kubernetes所有节点上重启主机<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure></p><blockquote><p>由于篇幅太长，我就用两章来介绍高可用 Kubernetes 的安装过程。下一张是最重要的安装内容！</p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/play%20with%20kubernetes.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Kubernetes" scheme="https://www.corkercode.com/categories/Kubernetes/"/>
    
    
      <category term="kubernetes" scheme="https://www.corkercode.com/tags/kubernetes/"/>
    
      <category term="docker" scheme="https://www.corkercode.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>使用 kubeadm 搭建 k8s-1.10.0 开发测试集群环境</title>
    <link href="https://www.corkercode.com/2018/12/14/%E4%BD%BF%E7%94%A8-kubeadm-%E6%90%AD%E5%BB%BA-k8s-1-10-0-%E5%BC%80%E5%8F%91%E6%B5%8B%E8%AF%95%E9%9B%86%E7%BE%A4%E7%8E%AF%E5%A2%83/"/>
    <id>https://www.corkercode.com/2018/12/14/使用-kubeadm-搭建-k8s-1-10-0-开发测试集群环境/</id>
    <published>2018-12-14T09:32:37.000Z</published>
    <updated>2019-01-27T16:15:22.753Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/k8s1.jpg" alt=""></div><a id="more"></a><h1 id="环境描述"><a href="#环境描述" class="headerlink" title="环境描述"></a>环境描述</h1><p>采用CentOS7.5，docker 1.13，kubeadm 1.10.0，etcd 3.0， k8s 1.10.0<br>我们这里选用三个节点搭建一个实验环境。<br>172.24.12.32 k8smaster<br>172.24.12.33 k8snode1<br>172.24.12.34 k8snode2</p><h1 id="准备环境"><a href="#准备环境" class="headerlink" title="准备环境"></a>准备环境</h1><p>参照上篇文章<br>配置好各节点hosts文件<br>关闭各节点系统防火墙<br>关闭各节点SElinux<br>关闭各节点swap<br>配置各节点系统内核参数使流过网桥的流量也进入iptables/netfilter框架中，在/etc/sysctl.conf中添加以下配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">sysctl -p</span><br></pre></td></tr></table></figure></p><h1 id="使用kubeadm安装："><a href="#使用kubeadm安装：" class="headerlink" title="使用kubeadm安装："></a>使用kubeadm安装：</h1><p>​</p><h2 id="首先配置各节点阿里K8S-YUM源"><a href="#首先配置各节点阿里K8S-YUM源" class="headerlink" title="首先配置各节点阿里K8S YUM源"></a>首先配置各节点阿里K8S YUM源</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">EOF</span><br><span class="line">yum -y install epel-release</span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure><h2 id="在各节点安装kubeadm和相关工具包"><a href="#在各节点安装kubeadm和相关工具包" class="headerlink" title="在各节点安装kubeadm和相关工具包"></a>在各节点安装kubeadm和相关工具包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker kubernetes-cni-0.6.0-0.x86_64 kubelet-1.10.0-0.x86_64 kubectl-1.10.0-0.x86_64 kubeadm-1.10.0-0.x86_64</span><br></pre></td></tr></table></figure><h2 id="启动Docker与kubelet服务"><a href="#启动Docker与kubelet服务" class="headerlink" title="启动Docker与kubelet服务"></a>启动Docker与kubelet服务</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable docker &amp;&amp; systemctl start docker</span><br><span class="line">systemctl enable kubelet &amp;&amp; systemctl start kubelet</span><br></pre></td></tr></table></figure><p>​<br><strong>提示：此时kubelet的服务运行状态是异常的，因为缺少主配置文件kubelet.conf。但可以暂不处理，因为在完成Master节点的初始化后才会生成这个配置文件。</strong><br>​</p><h2 id="下载K8S相关镜像（Master节点操作）"><a href="#下载K8S相关镜像（Master节点操作）" class="headerlink" title="下载K8S相关镜像（Master节点操作）"></a>下载K8S相关镜像（Master节点操作）</h2><p>开始下载k8s相关镜像，下载后将镜像名改为k8s.gcr.io/开头的名字，以便kubeadm识别使用。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#!/bin/bash</span><br><span class="line">images=(kube-proxy-amd64:v1.10.0 kube-scheduler-amd64:v1.10.0 kube-controller-manager-amd64:v1.10.0 kube-apiserver-amd64:v1.10.0</span><br><span class="line">etcd-amd64:3.1.12 pause-amd64:3.1 kubernetes-dashboard-amd64:v1.8.3 k8s-dns-sidecar-amd64:1.14.8 k8s-dns-kube-dns-amd64:1.14.8</span><br><span class="line">k8s-dns-dnsmasq-nanny-amd64:1.14.8)</span><br><span class="line">for imageName in $&#123;images[@]&#125; ; do</span><br><span class="line">  docker pull keveon/$imageName</span><br><span class="line">  docker tag keveon/$imageName k8s.gcr.io/$imageName</span><br><span class="line">  docker rmi keveon/$imageName</span><br><span class="line">done</span><br></pre></td></tr></table></figure></p><p>​<br>上面的shell脚本主要做了3件事，下载各种需要用到的容器镜像、重新打标记为符合k8s命令规范的版本名称、清除旧的容器镜像。<br>提示：镜像版本一定要和kubeadm安装的版本一致，否则会出现time out问题。<br>​</p><h2 id="初始化安装K8S-Master"><a href="#初始化安装K8S-Master" class="headerlink" title="初始化安装K8S Master"></a>初始化安装K8S Master</h2><p>执行上述shell脚本，等待下载完成后，执行kubeadm init<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">[root@k8smaster ~]# kubeadm init --kubernetes-version=v1.10.0 --pod-network-cidr=10.244.0.0/16</span><br><span class="line">[init] Using Kubernetes version: v1.10.0</span><br><span class="line">[init] Using Authorization modes: [Node RBAC]</span><br><span class="line">[preflight] Running pre-flight checks.</span><br><span class="line">    [WARNING Service-Kubelet]: kubelet service is not enabled, please run &apos;systemctl enable kubelet.service&apos;</span><br><span class="line">    [WARNING FileExisting-crictl]: crictl not found in system path</span><br><span class="line">Suggestion: go get github.com/kubernetes-incubator/cri-tools/cmd/crictl</span><br><span class="line">[preflight] Starting the kubelet service</span><br><span class="line">[certificates] Generated ca certificate and key.</span><br><span class="line">[certificates] Generated apiserver certificate and key.</span><br><span class="line">[certificates] apiserver serving cert is signed for DNS names [k8smaster kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 10.0.100.202]</span><br><span class="line">[certificates] Generated apiserver-kubelet-client certificate and key.</span><br><span class="line">[certificates] Generated etcd/ca certificate and key.</span><br><span class="line">[certificates] Generated etcd/server certificate and key.</span><br><span class="line">[certificates] etcd/server serving cert is signed for DNS names [localhost] and IPs [127.0.0.1]</span><br><span class="line">[certificates] Generated etcd/peer certificate and key.</span><br><span class="line">[certificates] etcd/peer serving cert is signed for DNS names [k8smaster] and IPs [10.0.100.202]</span><br><span class="line">[certificates] Generated etcd/healthcheck-client certificate and key.</span><br><span class="line">[certificates] Generated apiserver-etcd-client certificate and key.</span><br><span class="line">[certificates] Generated sa key and public key.</span><br><span class="line">[certificates] Generated front-proxy-ca certificate and key.</span><br><span class="line">[certificates] Generated front-proxy-client certificate and key.</span><br><span class="line">[certificates] Valid certificates and keys now exist in &quot;/etc/kubernetes/pki&quot;</span><br><span class="line">[kubeconfig] Wrote KubeConfig file to disk: &quot;/etc/kubernetes/admin.conf&quot;</span><br><span class="line">[kubeconfig] Wrote KubeConfig file to disk: &quot;/etc/kubernetes/kubelet.conf&quot;</span><br><span class="line">[kubeconfig] Wrote KubeConfig file to disk: &quot;/etc/kubernetes/controller-manager.conf&quot;</span><br><span class="line">[kubeconfig] Wrote KubeConfig file to disk: &quot;/etc/kubernetes/scheduler.conf&quot;</span><br><span class="line">[controlplane] Wrote Static Pod manifest for component kube-apiserver to &quot;/etc/kubernetes/manifests/kube-apiserver.yaml&quot;</span><br><span class="line">[controlplane] Wrote Static Pod manifest for component kube-controller-manager to &quot;/etc/kubernetes/manifests/kube-controller-manager.yaml&quot;</span><br><span class="line">[controlplane] Wrote Static Pod manifest for component kube-scheduler to &quot;/etc/kubernetes/manifests/kube-scheduler.yaml&quot;</span><br><span class="line">[etcd] Wrote Static Pod manifest for a local etcd instance to &quot;/etc/kubernetes/manifests/etcd.yaml&quot;</span><br><span class="line">[init] Waiting for the kubelet to boot up the control plane as Static Pods from directory &quot;/etc/kubernetes/manifests&quot;.</span><br><span class="line">[init] This might take a minute or longer if the control plane images have to be pulled.</span><br><span class="line">[apiclient] All control plane components are healthy after 21.001790 seconds</span><br><span class="line">[uploadconfig] Storing the configuration used in ConfigMap &quot;kubeadm-config&quot; in the &quot;kube-system&quot; Namespace</span><br><span class="line">[markmaster] Will mark node k8smaster as master by adding a label and a taint</span><br><span class="line">[markmaster] Master k8smaster tainted and labelled with key/value: node-role.kubernetes.io/master=&quot;&quot;</span><br><span class="line">[bootstraptoken] Using token: thczis.64adx0imeuhu23xv</span><br><span class="line">[bootstraptoken] Configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials</span><br><span class="line">[bootstraptoken] Configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token</span><br><span class="line">[bootstraptoken] Configured RBAC rules to allow certificate rotation for all node client certificates in the cluster</span><br><span class="line">[bootstraptoken] Creating the &quot;cluster-info&quot; ConfigMap in the &quot;kube-public&quot; namespace</span><br><span class="line">[addons] Applied essential addon: kube-dns</span><br><span class="line">[addons] Applied essential addon: kube-proxy</span><br><span class="line">Your Kubernetes master has initialized successfully!</span><br><span class="line">To start using your cluster, you need to run the following as a regular user:</span><br><span class="line">  mkdir -p $HOME/.kube</span><br><span class="line">  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">  sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br><span class="line">You should now deploy a pod network to the cluster.</span><br><span class="line">Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:</span><br><span class="line">  https://kubernetes.io/docs/concepts/cluster-administration/addons/</span><br><span class="line">You can now join any number of machines by running the following on each node</span><br><span class="line">as root:</span><br><span class="line">  kubeadm join 10.0.100.202:6443 --token thczis.64adx0imeuhu23xv --discovery-token-ca-cert-hash sha256:fa7b11bb569493fd44554aab0afe55a4c051cccc492dbdfafae6efeb6ffa80e6</span><br></pre></td></tr></table></figure></p><p>​<br>​<br><strong>提示：选项–kubernetes-version=v1.10.0是必须的，否则会因为访问google网站被墙而无法执行命令。这里使用v1.10.0版本，刚才前面也说到了下载的容器镜像版本必须与K8S版本一致否则会出现time out。<br>上面的命令大约需要1分钟的过程，期间可以观察下tail -f /var/log/message日志文件的输出，掌握该配置过程和进度。上面最后一段的输出信息保存一份，后续添加工作节点还要用到。</strong><br>​</p><h2 id="配置kubectl认证信息（Master节点操作）"><a href="#配置kubectl认证信息（Master节点操作）" class="headerlink" title="配置kubectl认证信息（Master节点操作）"></a>配置kubectl认证信息（Master节点操作）</h2><ul><li><p>对于非root用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br></pre></td></tr></table></figure></li><li><p>对于root用户</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export KUBECONFIG=/etc/kubernetes/admin.conf</span><br></pre></td></tr></table></figure></li></ul><p>​</p><h2 id="安装flannel网络（Master节点操作）"><a href="#安装flannel网络（Master节点操作）" class="headerlink" title="安装flannel网络（Master节点操作）"></a>安装flannel网络（Master节点操作）</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/cni/net.d/</span><br><span class="line">cat &lt;&lt;EOF&gt; /etc/cni/net.d/10-flannel.conf</span><br><span class="line">&#123;</span><br><span class="line">“name”: “cbr0”,</span><br><span class="line">“type”: “flannel”,</span><br><span class="line">“delegate”: &#123;</span><br><span class="line">“isDefaultGateway”: true</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br><span class="line">mkdir /usr/share/oci-umount/oci-umount.d -p</span><br><span class="line">mkdir /run/flannel/</span><br><span class="line">cat &lt;&lt;EOF&gt; /run/flannel/subnet.env</span><br><span class="line">FLANNEL_NETWORK=10.244.0.0/16</span><br><span class="line">FLANNEL_SUBNET=10.244.1.0/24</span><br><span class="line">FLANNEL_MTU=1450</span><br><span class="line">FLANNEL_IPMASQ=true</span><br><span class="line">EOF</span><br><span class="line">kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/v0.9.1/Documentation/kube-flannel.yml</span><br></pre></td></tr></table></figure><p>​</p><h2 id="让node1、node2加入集群"><a href="#让node1、node2加入集群" class="headerlink" title="让node1、node2加入集群"></a>让node1、node2加入集群</h2><p>在node1和node2节点上分别执行kubeadm join命令，加入集群：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@k8snode1 ~]# kubeadm join 10.0.100.202:6443 --token thczis.64adx0imeuhu23xv --discovery-token-ca-cert-hash sha256:fa7b11bb569493fd44554aab0afe55a4c051cccc492dbdfafae6efeb6ffa80e6</span><br><span class="line">[preflight] Running pre-flight checks.</span><br><span class="line">    [WARNING Service-Kubelet]: kubelet service is not enabled, please run &apos;systemctl enable kubelet.service&apos;</span><br><span class="line">    [WARNING FileExisting-crictl]: crictl not found in system path</span><br><span class="line">Suggestion: go get github.com/kubernetes-incubator/cri-tools/cmd/crictl</span><br><span class="line">[discovery] Trying to connect to API Server &quot;10.0.100.202:6443&quot;</span><br><span class="line">[discovery] Created cluster-info discovery client, requesting info from &quot;https://10.0.100.202:6443&quot;</span><br><span class="line">[discovery] Requesting info from &quot;https://10.0.100.202:6443&quot; again to validate TLS against the pinned public key</span><br><span class="line">[discovery] Cluster info signature and contents are valid and TLS certificate validates against pinned roots, will use API Server &quot;10.0.100.202:6443&quot;</span><br><span class="line">[discovery] Successfully established connection with API Server &quot;10.0.100.202:6443&quot;</span><br><span class="line">This node has joined the cluster:</span><br><span class="line">* Certificate signing request was sent to master and a response</span><br><span class="line">  was received.</span><br><span class="line">* The Kubelet was informed of the new secure connection details.</span><br><span class="line">Run &apos;kubectl get nodes&apos; on the master to see this node join the cluster.</span><br></pre></td></tr></table></figure></p><p>提示：这段命令其实就是前面K8S Matser安装成功后我让你们保存的那段命令。<br>默认情况下，Master节点不参与工作负载，但如果希望安装出一个All-In-One的k8s环境，则可以执行以下命令，让Master节点也成为一个Node节点：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl taint nodes --all node-role.kubernetes.io/master-`</span><br></pre></td></tr></table></figure></p><p>​<br>​</p><h2 id="验证K8S-Master是否搭建成功（Master节点操作）"><a href="#验证K8S-Master是否搭建成功（Master节点操作）" class="headerlink" title="验证K8S Master是否搭建成功（Master节点操作）"></a>验证K8S Master是否搭建成功（Master节点操作）</h2><p>​</p><ul><li>查看节点状态<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get nodes</span><br></pre></td></tr></table></figure></li></ul><p>​</p><ul><li>查看pods状态<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods --all-namespaces</span><br></pre></td></tr></table></figure></li></ul><p>​</p><ul><li>查看K8S集群状态<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get cs</span><br></pre></td></tr></table></figure></li></ul><p>​</p><h2 id="当安装失败了，怎么清理环境重新安装啊？下面教大家一条命令："><a href="#当安装失败了，怎么清理环境重新安装啊？下面教大家一条命令：" class="headerlink" title="当安装失败了，怎么清理环境重新安装啊？下面教大家一条命令："></a>当安装失败了，怎么清理环境重新安装啊？下面教大家一条命令：</h2><p>​<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm reset</span><br></pre></td></tr></table></figure></p><p>​<br>好了，至此就完成了K8S三节点集群的安装部署。</p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/k8s1.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Kubernetes" scheme="https://www.corkercode.com/categories/Kubernetes/"/>
    
    
      <category term="kubernetes" scheme="https://www.corkercode.com/tags/kubernetes/"/>
    
      <category term="docker" scheme="https://www.corkercode.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>基于 kubeadm 的 kubernetes 高可用集群部署&lt;二&gt;</title>
    <link href="https://www.corkercode.com/2018/12/14/%E5%9F%BA%E4%BA%8E-kubeadm-%E7%9A%84-kubernetes-%E9%AB%98%E5%8F%AF%E7%94%A8%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2-%E4%BA%8C/"/>
    <id>https://www.corkercode.com/2018/12/14/基于-kubeadm-的-kubernetes-高可用集群部署-二/</id>
    <published>2018-12-14T09:32:37.000Z</published>
    <updated>2019-01-27T16:15:41.905Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/play%20with%20kubernetes.png" alt=""></div><a id="more"></a><blockquote><p>上一篇我们的基本工作已经准备完成，这篇我们说重要的安装过程。</p></blockquote><h3 id="kubernetes-相关服务安装"><a href="#kubernetes-相关服务安装" class="headerlink" title="kubernetes 相关服务安装"></a>kubernetes 相关服务安装</h3><ol><li>在 kubernetes 所有节点上验证 SELINUX 模式，必须保证 SELINUX 为 permissive 模式，否则 kubernetes 启动会出现各种异常。</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# getenforcePermissive</span><br></pre></td></tr></table></figure><ol start="2"><li>在 kubernetes 所有节点上安装并启动 kubernetes 和 docker</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y kubernetes-cni-0.6.0-0.x86_64 kubelet-1.10.3-0.x86_64 kubectl-1.10.3-0.x86_64 kubeadm-1.10.3-0.x86_64systemctl enable docker &amp;&amp; systemctl start dockersystemctl enable kubelet &amp;&amp; systemctl start kubelet</span><br></pre></td></tr></table></figure><ol start="3"><li>独立 etcd 集群部署</li></ol><ul><li>在 k8s-master1 节点上以 docker 方式启动 etcd 集群</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker stop etcd &amp;&amp; docker rm etcd$ rm -rf /var/lib/etcd-cluster$ mkdir -p /var/lib/etcd-cluster$ docker run -d \--restart always \-v /etc/ssl/certs:/etc/ssl/certs \-v /var/lib/etcd-cluster:/var/lib/etcd \-p 4001:4001 \-p 2380:2380 \-p 2379:2379 \--name etcd \k8s.gcr.io/etcd-amd64:3.2.17 \etcd --name=etcd0 \--advertise-client-urls=http://172.24.12.32:2379,http://172.24.12.32:4001 \--listen-client-urls=http://0.0.0.0:2379,http://0.0.0.0:4001 \--initial-advertise-peer-urls=http://172.24.12.32:2380 \--listen-peer-urls=http://0.0.0.0:2380 \--initial-cluster-token=9477af68bbee1b9ae037d6fd9e7efefd \--initial-cluster=etcd0=http://172.24.12.32:2380,etcd1=http://172.24.12.33:2380,etcd2=http://172.24.12.34:2380 \--initial-cluster-state=new \--auto-tls \--peer-auto-tls \--data-dir=/var/lib/etcd</span><br></pre></td></tr></table></figure><ul><li>在 k8s-master2 节点上以 docker 方式启动 etcd 集群</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker stop etcd &amp;&amp; docker rm etcd$ rm -rf /var/lib/etcd-cluster$ mkdir -p /var/lib/etcd-cluster$ docker run -d \--restart always \-v /etc/ssl/certs:/etc/ssl/certs \-v /var/lib/etcd-cluster:/var/lib/etcd \-p 4001:4001 \-p 2380:2380 \-p 2379:2379 \--name etcd \k8s.gcr.io/etcd-amd64:3.2.17 \etcd --name=etcd1 \--advertise-client-urls=http://172.24.12.33:2379,http://172.24.12.33:4001 \--listen-client-urls=http://0.0.0.0:2379,http://0.0.0.0:4001 \--initial-advertise-peer-urls=http://172.24.12.33:2380 \--listen-peer-urls=http://0.0.0.0:2380 \--initial-cluster-token=9477af68bbee1b9ae037d6fd9e7efefd \--initial-cluster=etcd0=http://172.24.12.32:2380,etcd1=http://172.24.12.33:2380,etcd2=http://172.24.12.34:2380 \--initial-cluster-state=new \--auto-tls \--peer-auto-tls \--data-dir=/var/lib/etcd</span><br></pre></td></tr></table></figure><ul><li>在 k8s-master3 节点上以 docker 方式启动 etcd 集群</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker stop etcd &amp;&amp; docker rm etcd$ rm -rf /var/lib/etcd-cluster$ mkdir -p /var/lib/etcd-cluster$ docker run -d \--restart always \-v /etc/ssl/certs:/etc/ssl/certs \-v /var/lib/etcd-cluster:/var/lib/etcd \-p 4001:4001 \-p 2380:2380 \-p 2379:2379 \--name etcd \k8s.gcr.io/etcd-amd64:3.2.17 \etcd --name=etcd2 \--advertise-client-urls=http://172.24.12.34:2379,http://172.24.12.34:4001 \--listen-client-urls=http://0.0.0.0:2379,http://0.0.0.0:4001 \--initial-advertise-peer-urls=http://172.24.12.34:2380 \--listen-peer-urls=http://0.0.0.0:2380 \--initial-cluster-token=9477af68bbee1b9ae037d6fd9e7efefd \--initial-cluster=etcd0=http://172.24.12.32:2380,etcd1=http://172.24.12.33:2380,etcd2=http://172.24.12.34:2380 \--initial-cluster-state=new \--auto-tls \--peer-auto-tls \--data-dir=/var/lib/etcd</span><br></pre></td></tr></table></figure><ul><li>在 k8s-master1、k8s-master2、k8s-master3 上检查 etcd 启动状态</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# docker exec -ti etcd ash/ # etcdctl member list7952c466eeed1e71: name=etcd0 peerURLs=http://172.24.12.32:2380 clientURLs=http://172.24.12.32:2379,http://172.24.12.32:4001 isLeader=falseea0f9c89ab07d1c2: name=etcd2 peerURLs=http://172.24.12.34:2380 clientURLs=http://172.24.12.34:2379,http://172.24.12.34:4001 isLeader=truefd15cb75a309af35: name=etcd1 peerURLs=http://172.24.12.33:2380 clientURLs=http://172.24.12.33:2379,http://172.24.12.33:4001 isLeader=false/ # etcdctl cluster-healthmember 7952c466eeed1e71 is healthy: got healthy result from http://172.24.12.32:2379member ea0f9c89ab07d1c2 is healthy: got healthy result from http://172.24.12.34:2379member fd15cb75a309af35 is healthy: got healthy result from http://172.24.12.33:2379cluster is healthy/ # exit</span><br></pre></td></tr></table></figure><ol start="4"><li>kubeadm 初始化</li></ol><ul><li>在 k8s-master1 上修改 kubeadm-init.yaml 文件，设置 etcd.endpoints 的<code>${HOST_IP}</code>为 k8s-master1、k8s-master2、k8s-master3 的 IP 地址</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# cat kubeadm-init.yamlapiVersion: kubeadm.k8s.io/v1alpha1kind: MasterConfigurationkubernetesVersion: v1.10.3networking:  podSubnet: 10.244.0.0/16apiServerCertSANs:- k8s-master1- k8s-master2- k8s-master3- 172.24.12.32- 172.24.12.33- 172.24.12.34- 172.24.12.80etcd:  endpoints:  - http://172.24.12.32:2379  - http://172.24.12.33:2379  - http://172.24.12.34:2379</span><br></pre></td></tr></table></figure><p><strong>注：如果使用kubeadm初始化集群，启动过程可能会卡在以下位置，那么可能是因为 cgroup-driver 参数与 docker 的不一致引起，如下：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[apiclient] Created API client, waiting for the control plane to become ready$ journalctl -t kubelet -S &apos;2017-06-08&apos; #查看日志，发现如下错误error: failed to run Kubelet: failed to create kubelet: misconfiguration: kubelet cgroup driver: &quot;systemd&quot;</span><br></pre></td></tr></table></figure><p>需要修改 KUBELET_CGROUP_ARGS=–cgroup-driver=systemd 为 KUBELET_CGROUP_ARGS=–cgroup-driver=cgroupfs</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/systemd/system/kubelet.service.d/10-kubeadm.conf#Environment=&quot;KUBELET_CGROUP_ARGS=--cgroup-driver=systemd&quot; Environment=&quot;KUBELET_CGROUP_ARGS=--cgroup-driver=cgroupfs&quot;</span><br></pre></td></tr></table></figure><ul><li>在 k8s-master1 上使用 kubeadm 初始化 kubernetes 集群，连接外部 etcd 集群</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubeadm init --config=/home/yaml/kubeadm-init.yaml</span><br></pre></td></tr></table></figure><ul><li>在 k8s-master1 上设置 kubectl 的环境变量 KUBECONFIG，连接 kubelet</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi ~/.bashrc export KUBECONFIG=/etc/kubernetes/admin.conf$ source ~/.bashrc</span><br></pre></td></tr></table></figure><ol start="5"><li>flannel 网络组件安装</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl create -f /home/yaml/kube-flannel.yml</span><br></pre></td></tr></table></figure><p>在 k8s-master1 上验证 kube-dns 成功启动，大概等待3分钟，验证所有 pods 的状态为 Running，验证方式见 <a href="https://www.jianshu.com/p/08b6454ebfc1" target="_blank" rel="noopener">k8s-测试dns</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get pods --all-namespaces -o wide</span><br></pre></td></tr></table></figure><ol start="6"><li>dashboard 和 heapster 组件安装</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create -f /home/yaml/kubernetes-dashboard-admin.rbac.yamlkubectl create -f /home/yaml/kubernetes-dashboard.yaml</span><br></pre></td></tr></table></figure><p><strong>注：在 k8s-master1 上允许在 master 上部署 pod，否则 heapster 会无法部署，执行以下命令：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl taint nodes --all node-role.kubernetes.io/master-node &quot;k8s-master1&quot; taintedkubectl create -f /home/yaml/heapster-rbac.yamlkubectl create -f /home/yaml/heapster.yaml</span><br></pre></td></tr></table></figure><p>在本机上访问 dashboard 地址 <a href="http://172.24.12.32:30090，验证" target="_blank" rel="noopener">http://172.24.12.32:30090，验证</a> heapster 成功启动，查看 Pods 的 CPU 以及 Memory 信息是否正常呈现，如下：</p><p><img src="http://upload-images.jianshu.io/upload_images/7269465-de901cce4ae89230.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="dashboard" title="dashboard"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">dashboard</figcaption><p>至此，第一台 master 成功安装，并已经完成 flannel、dashboard、heapster 的部署。</p><h3 id="master-集群高可用设置"><a href="#master-集群高可用设置" class="headerlink" title="master 集群高可用设置"></a>master 集群高可用设置</h3><ol><li>在 k8s-master1 上把 /etc/kubernetes/ 复制到 k8s-master2、k8s-master3</li><li>在 k8s-master2、k8s-master3 上重启 kubelet 服务，并检查 kubelet 服务状态为 active (running)</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload &amp;&amp; systemctl restart kubelet</span><br></pre></td></tr></table></figure><ol start="3"><li>在 k8s-master2、k8s-master3 上设置 kubectl 的环境变量 KUBECONFIG，连接 kubelet</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi ~/.bashrcexport KUBECONFIG=/etc/kubernetes/admin.conf$ source ~/.bashrc</span><br></pre></td></tr></table></figure><ol start="4"><li>在 k8s-master2、k8s-master3 检测节点状态，发现节点已经加进来</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# kubectl get nodes -o wide</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-ce9762828815f5c3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nodes" title="nodes"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">nodes</figcaption><ol start="5"><li>在 k8s-master2、k8s-master3 上修改 kube-apiserver.yaml 的配置，<code>${HOST_IP}</code>改为本机 IP</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/kubernetes/manifests/kube-apiserver.yaml- --advertise-address=$&#123;HOST_IP&#125;</span><br></pre></td></tr></table></figure><ol start="6"><li>在 k8s-master2 和 k8s-master3 上的修改 kubelet.conf 设置，<code>${HOST_IP}</code>改为本机 IP</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/kubernetes/kubelet.confserver: https://$&#123;HOST_IP&#125;:6443</span><br></pre></td></tr></table></figure><ol start="7"><li>在 k8s-master2 和 k8s-master3 上的重启服务</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl daemon-reload &amp;&amp; systemctl restart docker kubelet</span><br></pre></td></tr></table></figure><ol start="8"><li>创建证书<br>(1)在 k8s-master2 和 k8s-master3 上修改 kubelet.conf 后，由于 kubelet.conf 配置的 crt 和 key 与本机 IP 地址不一致的情况，kubelet 服务会异常退出，crt 和 key 必须重新制作。查看 apiserver.crt 的签名信息，发现 IP Address 以及 DNS 绑定了 k8s-master1，必须进行相应修改。</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ openssl x509 -noout -text -in /etc/kubernetes/pki/apiserver.crt</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-785945c74b422195.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="k8s-apiserver.crt" title="k8s-apiserver.crt"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">k8s-apiserver.crt</figcaption><p>(2)在 k8s-master1、k8s-master2、k8s-master3 上使用 ca.key 和 ca.crt 制作 apiserver.crt 和<br>apiserver.key</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p /etc/kubernetes/pki-local$ cd /etc/kubernetes/pki-local</span><br></pre></td></tr></table></figure><p>(3)在 k8s-master1、k8s-master2、k8s-master3 上生成 2048 位的密钥对</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ openssl genrsa -out apiserver.key 2048</span><br></pre></td></tr></table></figure><p>(4)在 k8s-master1、k8s-master2、k8s-master3 上生成证书签署请求文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ openssl req -new -key apiserver.key -subj &quot;/CN=kube-apiserver,&quot; -out apiserver.csr</span><br></pre></td></tr></table></figure><p>(5)在 k8s-master1、k8s-master2、k8s-master3 上编辑 apiserver.ext 文件，<code>${HOST_NAME}</code>修改为本机主机名，<code>${HOST_IP}</code>修改为本机 IP 地址，<code>${VIRTUAL_IP}</code>修改为 keepalived 的虚拟 IP（172.24.12.80）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi apiserver.extsubjectAltName = DNS:$&#123;HOST_NAME&#125;,DNS:kubernetes,DNS:kubernetes.default,DNS:kubernetes.default.svc, DNS:kubernetes.default.svc.cluster.local, IP:10.96.0.1, IP:$&#123;HOST_IP&#125;, IP:$&#123;VIRTUAL_IP&#125;</span><br></pre></td></tr></table></figure><p>(6)在 k8s-master1、k8s-master2、k8s-master3 上使用 ca.key 和 ca.crt 签署上述请求</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ openssl x509 -req -in apiserver.csr -CA /etc/kubernetes/pki/ca.crt -CAkey /etc/kubernetes/pki/ca.key -CAcreateserial -out apiserver.crt -days 365 -extfile /etc/kubernetes/pki-local/apiserver.ext</span><br></pre></td></tr></table></figure><p>(7)在 k8s-master1、k8s-master2、k8s-master3 上查看新生成的证书：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ openssl x509 -noout -text -in apiserver.crt</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-5a0854759306eb8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="k8s-apiserver.crt2" title="k8s-apiserver.crt2"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">k8s-apiserver.crt2</figcaption><p>(8)在 k8s-master1、k8s-master2、k8s-master3 上把 apiserver.crt 和 apiserver.key 文件复制到 /etc/kubernetes/pki 目录</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp apiserver.crt apiserver.key /etc/kubernetes/pki/</span><br></pre></td></tr></table></figure><ol start="9"><li>在 k8s-master2 和 k8s-master3 上修改 admin.conf，<code>${HOST_IP}</code>修改为本机 IP 地址</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/kubernetes/admin.confserver: https://$&#123;HOST_IP&#125;:6443</span><br></pre></td></tr></table></figure><ol start="10"><li>在 k8s-master2 和 k8s-master3 上修改 controller-manager.conf，<code>${HOST_IP}</code>修改为本机 IP 地址</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/kubernetes/controller-manager.confserver: https://$&#123;HOST_IP&#125;:6443</span><br></pre></td></tr></table></figure><ol start="11"><li>在 k8s-master2 和 k8s-master3 上修改 scheduler.conf，<code>${HOST_IP}</code>修改为本机 IP 地址</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/kubernetes/scheduler.confserver: https://$&#123;HOST_IP&#125;:6443</span><br></pre></td></tr></table></figure><ol start="12"><li>在 k8s-master1、k8s-master2、k8s-master3 上重启所有服务</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl daemon-reload &amp;&amp; systemctl restart docker kubelet</span><br></pre></td></tr></table></figure><h3 id="验证高可用安装"><a href="#验证高可用安装" class="headerlink" title="验证高可用安装"></a>验证高可用安装</h3><ol><li>在 k8s-master1、k8s-master2、k8s-master3 任意节点上检测服务启动情况，发现 apiserver、controller-manager、kube-scheduler、proxy、flannel 已经在 k8s-master1、k8s-master2、k8s-master3 成功启动</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get pod --all-namespaces -o wide | grep k8s-master1$ kubectl get pod --all-namespaces -o wide | grep k8s-master2$ kubectl get pod --all-namespaces -o wide | grep k8s-master3</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-c235daafcd55367d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="服务启动情况" title="服务启动情况"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">服务启动情况</figcaption><ol start="2"><li>在 k8s-master1、k8s-master2、k8s-master3 任意节点上通过 kubectl logs 检查各个 controller-manager 和 scheduler 的 leader election 结果，可以发现只有一个节点有效表示选举正常</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl logs -n kube-system kube-controller-manager-k8s-master1$ kubectl logs -n kube-system kube-controller-manager-k8s-master2$ kubectl logs -n kube-system kube-controller-manager-k8s-master3$ kubectl logs -n kube-system kube-scheduler-k8s-master1$ kubectl logs -n kube-system kube-scheduler-k8s-master2$ kubectl logs -n kube-system kube-scheduler-k8s-master3</span><br></pre></td></tr></table></figure><ol start="3"><li>在 k8s-master1、k8s-master2、k8s-master3 任意节点上查看 deployment 的情况</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get deploy --all-namespaces</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-3478426f78dc9998.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="deployment的情况" title="deployment的情况"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">deployment的情况</figcaption><ol start="4"><li>在 k8s-master1、k8s-master2、k8s-master3 任意节点上把 kubernetes-dashboard、kube-dns、 scale up 扩成 replicas=3，保证各个 master 节点上都有运行</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl scale --replicas=3 -n kube-system deployment/kube-dns$ kubectl get pods --all-namespaces -o wide| grep kube-dns$ kubectl scale --replicas=3 -n kube-system deployment/kubernetes-dashboard$ kubectl get pods --all-namespaces -o wide| grep kubernetes-dashboard$ kubectl scale --replicas=3 -n kube-system deployment/heapster$ kubectl get pods --all-namespaces -o wide| grep heapster</span><br></pre></td></tr></table></figure><h3 id="keepalived-安装配置"><a href="#keepalived-安装配置" class="headerlink" title="keepalived 安装配置"></a>keepalived 安装配置</h3><ol><li>在 k8s-master、k8s-master2、k8s-master3 上安装 keepalived</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ yum install -y keepalived$ systemctl enable keepalived &amp;&amp; systemctl restart keepalived</span><br></pre></td></tr></table></figure><ol start="2"><li>在 k8s-master1、k8s-master2、k8s-master3 上备份 keepalived 配置文件</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mv /etc/keepalived/keepalived.conf /etc/keepalived/keepalived.conf.bak</span><br></pre></td></tr></table></figure><ol start="3"><li>在 k8s-master1、k8s-master2、k8s-master3 上设置 apiserver 监控脚本，当 apiserver 检测失败的时候关闭 keepalived 服务，转移虚拟 IP 地址</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/keepalived/check_apiserver.sh#!/bin/bash err=0 for k in $( seq 1 10 ) do check_code=$(ps -ef|grep kube-apiserver | wc -l) if [ &quot;$check_code&quot; = &quot;1&quot; ]; then err=$(expr $err + 1) sleep 5 continue else err=0 break fi done if [ &quot;$err&quot; != &quot;0&quot; ]; then echo &quot;systemctl stop keepalived&quot; /usr/bin/systemctl stop keepalived exit 1 else exit 0 fi$ chmod a+x /etc/keepalived/check_apiserver.sh</span><br></pre></td></tr></table></figure><ol start="4"><li>在 k8s-master1、k8s-master2、k8s-master3 上查看接口名字</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ip a | grep 172.24.12</span><br></pre></td></tr></table></figure><ol start="5"><li>在 k8s-master1、k8s-master2、k8s-master3 上设置 keepalived，参数说明如下：<br>state <code>${STATE}</code>：为 MASTER 或者 BACKUP，只能有一个 MASTER<br>interface <code>${INTERFACE_NAME</code>}：为本机的需要绑定的接口名字（通过上边的 ip a 命令查看）<br>mcast_src_ip <code>${HOST_IP}</code>：为本机的IP地址<br>priority <code>${PRIORITY}</code>：为优先级，例如 102、101、100，优先级越高越容易选择为 MASTER，优先级不能一样， master设置应高于 backup<br><code>${VIRTUAL_IP}</code>：为虚拟的 IP 地址，这里设置为 172.24.12.80</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /etc/keepalived/keepalived.conf</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-a4cad563360574fd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="keepalived参数设置" title="keepalived参数设置"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">keepalived参数设置</figcaption><ol start="6"><li>在 k8s-master1、k8s-master2、k8s-master3 上重启 keepalived 服务，检测虚拟 IP 地址是否生效</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl restart keepalived$ ping 172.24.12.80</span><br></pre></td></tr></table></figure><h4 id="nginx负载均衡配置"><a href="#nginx负载均衡配置" class="headerlink" title="nginx负载均衡配置"></a>nginx负载均衡配置</h4><ol><li>在 k8s-master1、k8s-master2、k8s-master3 上修改 nginx-default.conf设置，<code>${HOST_IP}</code>对应 k8s-master1、k8s-master2、k8s-master3 的地址。通过 nginx 把访问 apiserver 的 6443 端口负载均衡到 8433 端口上</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ vi /home/yaml/nginx-default.confstream &#123;   upstream apiserver &#123;     server $&#123;HOST_IP&#125;:6443 weight=5 max_fails=3 fail_timeout=30s;     server $&#123;HOST_IP&#125;:6443 weight=5 max_fails=3 fail_timeout=30s;     server $&#123;HOST_IP&#125;:6443 weight=5 max_fails=3 fail_timeout=30s;  &#125;  server &#123;     listen 8443;     proxy_connect_timeout 1s;     proxy_timeout 3s; proxy_pass apiserver;  &#125; &#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 k8s-master1、k8s-master2、k8s-master3 上启动 nginx 容器</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -d -p 8443:8443 \ --name nginx-lb \ --restart always \ -v /home/yaml/nginx-default.conf:/etc/nginx/nginx.conf \ nginx</span><br></pre></td></tr></table></figure><ol start="3"><li>在 k8s-master1、k8s-master2、k8s-master3 上检测 keepalived 服务的虚拟 IP 地址指向</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl -L 192.168.60.80:8443 | wc -l% Total % Received % Xferd Average Speed Time Time Time Current Dload Upload Total Spent Left Speed 100 14 0 14 0 0 18324 0 --:--:-- --:--:-- --:--:-- 14000 1</span><br></pre></td></tr></table></figure><ol start="4"><li>业务恢复后务必重启 keepalived，否则 keepalived 会处于关闭状态</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl restart keepalived</span><br></pre></td></tr></table></figure><ol start="5"><li>在 k8s-master1、k8s-master2、k8s-master3 上查看 keeplived 日志，有以下输出表示当前虚拟 IP 地址绑定的主机</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ systemctl status keepalived -lVRRP_Instance(VI_1) Sending gratuitous ARPs on ens160 for 172.24.12.80</span><br></pre></td></tr></table></figure><h4 id="kube-proxy配置"><a href="#kube-proxy配置" class="headerlink" title="kube-proxy配置"></a>kube-proxy配置</h4><ol><li>在 k8s-master1 上设置 kube-proxy 使用 keepalived 的虚拟IP地址，避免 k8s-master1 异常的时候所有节点的 kube-proxy 连接不上</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get -n kube-system configmap  NAME DATA AGE extension-apiserver-authentication 6 4h kube-flannel-cfg 2 4h kube-proxy 1 4h</span><br></pre></td></tr></table></figure><ol start="2"><li>在 k8s-master1 上修改 configmap/kube-proxy 的 server 指向 keepalived 的虚拟IP地址</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl edit -n kube-system configmap/kube-proxy  server: https://172.24.12.80:8443</span><br></pre></td></tr></table></figure><ol start="3"><li>在 k8s-master1 上查看 configmap/kube-proxy 设置情况</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get -n kube-system configmap/kube-proxy -o yaml</span><br></pre></td></tr></table></figure><ol start="4"><li>在 k8s-master1 上删除所有 kube-proxy 的 pod，让 proxy 重建</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods --all-namespaces -o wide | grep proxy</span><br></pre></td></tr></table></figure><ol start="5"><li>在 k8s-master1、k8s-master2、k8s-master3 上重启 docker kubelet keepalived 服务</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart docker kubelet keepalived</span><br></pre></td></tr></table></figure><h3 id="验证-master-集群高可用"><a href="#验证-master-集群高可用" class="headerlink" title="验证 master 集群高可用"></a>验证 master 集群高可用</h3><p>在 k8s-master1 上检查各个节点 pod 的启动状态，每个上都成功启动 heapster、kube-apiserver、kube-controller-manager、kube-dns、kube-flannel、kube-proxy、kube-scheduler、kubernetes-dashboard、monitoring-grafana、monitoring-influxdb。并且所有 pod 都处于 Running 状态表示正常</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get pods --all-namespaces -o wide | grep k8s-master1$ kubectl get pods --all-namespaces -o wide | grep k8s-master2$ kubectl get pods --all-namespaces -o wide | grep k8s-master3</span><br></pre></td></tr></table></figure><h3 id="node-节点加入高可用集群设置"><a href="#node-节点加入高可用集群设置" class="headerlink" title="node 节点加入高可用集群设置"></a>node 节点加入高可用集群设置</h3><ol><li>在 k8s-master1 上查看集群的 token</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubeadm token list</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-1fed0c3b0fef8ddb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="kubeadm token" title="kubeadm token"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">kubeadm token</figcaption><ol start="2"><li>在 k8s-node1~k8s-node8 上，<code>${TOKEN}</code>为 k8s-master1 上显示的 token，<code>${VIRTUAL_IP}</code>为 keepalived 的虚拟 IP 地址 172.24.12.80</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ kubeadm join --token $&#123;TOKEN&#125; $&#123;VIRTUAL_IP&#125;:8443</span><br></pre></td></tr></table></figure><ol start="3"><li>查看 kubelet status,确保 activing</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-node1 ~]# systemctl start  kubelet[root@k8s-node1 ~]# journalctl -xeu kubelet</span><br></pre></td></tr></table></figure><p><strong>注：如果有不必要的报错，使用下面 join 方法：</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-node1 ~]# kubeadm join --token efeayj.qa8q6c0ojo72crsn 172.24.12.80:8443 --ignore-preflight-errors &apos;all&apos; --discovery-token-unsafe-skip-ca-verification</span><br></pre></td></tr></table></figure><h4 id="部署应用验证集群"><a href="#部署应用验证集群" class="headerlink" title="部署应用验证集群"></a>部署应用验证集群</h4><ol><li>在 k8s-node1 ~ k8s-node8 上查看 kubelet 状态，kubelet 状态为 active (running) 表示 kubelet 服务正常启动</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status keepalived</span><br></pre></td></tr></table></figure><ol start="2"><li>在 k8s-master1 上检查各个节点状态，发现所有 k8s-nodes 节点成功加入</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# kubectl get nodes -o wide</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-137d10bf8407a071.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="kubectl get nodes" title="kubectl get nodes"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">kubectl get nodes</figcaption><ol start="3"><li>在 k8s-master1 上测试部署 nginx 服务，nginx 服务成功部署到 k8s-node1 上</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# kubectl run nginx --image=nginx --port=80[root@k8s-master1 yaml]# kubectl get pod -o wide -l=run=nginx</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-42ca76e12c3c2f47.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="run nginx" title="run nginx"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">run nginx</figcaption><ol start="4"><li>在 k8s-master1 让 nginx 服务外部可见</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# kubectl expose deployment nginx --port=80 --target-port=80 --type=NodePort[root@k8s-master1 yaml]# kubectl get svc -l=run=nginx</span><br></pre></td></tr></table></figure><p><img src="http://upload-images.jianshu.io/upload_images/7269465-90b2762635e6ead0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="nginx服务外部可见" title="nginx服务外部可见"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">nginx服务外部可见</figcaption><ol start="5"><li>访问测试</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master1 yaml]# curl 172.24.12.35:31012</span><br></pre></td></tr></table></figure><p>或者使用浏览器访问，如下：</p><p><img src="http://upload-images.jianshu.io/upload_images/7269465-4fa818a4180c6c50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="curl nginx" title="curl nginx"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">curl nginx</figcaption><p><img src="http://upload-images.jianshu.io/upload_images/7269465-22a6da85f6f40076.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="浏览器访问nginx" title="浏览器访问nginx"></p><figcaption style="line-height: inherit; margin: 0px; padding: 0px; margin-top: 10px; text-align: center; color: rgb(153, 153, 153); font-size: 0.7em;">浏览器访问nginx</figcaption><p><strong>至此，kubernetes 高可用集群成功部署！</strong></p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/play%20with%20kubernetes.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Kubernetes" scheme="https://www.corkercode.com/categories/Kubernetes/"/>
    
    
      <category term="kubernetes" scheme="https://www.corkercode.com/tags/kubernetes/"/>
    
      <category term="docker" scheme="https://www.corkercode.com/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>Nginx https 配置</title>
    <link href="https://www.corkercode.com/2018/09/23/Nginx-https-%E9%85%8D%E7%BD%AE/"/>
    <id>https://www.corkercode.com/2018/09/23/Nginx-https-配置/</id>
    <published>2018-09-23T13:12:21.000Z</published>
    <updated>2019-01-27T16:16:07.449Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/nginx-https.png" alt=""></div><a id="more"></a><blockquote><p>准备环境<br><a href="https://www.aliyun.com/product/ecs?spm=5176.8142029.selected.1.3dbd6d3eoW1oqj" target="_blank" rel="noopener">阿里云</a>      <a href="https://cloud.tencent.com/product/cvm" target="_blank" rel="noopener">腾讯云</a><br>部署好站点，且使用DNS解析到云服务器的IP地址</p></blockquote><p><strong>接下来就是配置HTTPS的关键步骤</strong></p><ol><li>申请证书并下载对应Nginx版本到本地</li><li>下载安装Nginx</li><li>修改Nginx配置文件</li><li>启动Nginx</li></ol><h1 id="申请证书"><a href="#申请证书" class="headerlink" title="申请证书"></a>申请证书</h1><p>证书申请有免费或收费的，我们当然要是有免费的。可到阿里云或者腾讯云的证书管理中申请，注意申请<a href="https://www.trustasia.com/" target="_blank" rel="noopener">亚洲诚信</a>SSL证书时需要绑定域名，申请完后下载证书zip包。</p><h1 id="下载安装Nginx"><a href="#下载安装Nginx" class="headerlink" title="下载安装Nginx"></a>下载安装Nginx</h1><p>到<a href="http://nginx.org/" target="_blank" rel="noopener">Nginx官网</a>下载最新版本15以上，并上传到服务器<em>/home</em>目录下<br>安装前先安装其依赖<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc-c++</span><br><span class="line">yum -y install pcre pcre-devel</span><br><span class="line">yum -y install zlib zlib-devel</span><br><span class="line">yum -y install openssl openssl-devel</span><br></pre></td></tr></table></figure></p><p>解压Nginx安装包tar.gz到<em>/home</em>目录下，并解析安装<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd /home</span><br><span class="line">tar -zxvf nginx-1.15.4.tar.gz</span><br><span class="line">cd nginx-1.15.4.tar.gz</span><br><span class="line">./configure --with-http_ssl_module</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure></p><p>到此Nginx安装完成，你可以使用以下命令尝试启动，并查看是否成功启动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx</span><br><span class="line">ps -ef|grep nginx</span><br></pre></td></tr></table></figure></p><h1 id="修改Nginx配置文件"><a href="#修改Nginx配置文件" class="headerlink" title="修改Nginx配置文件"></a>修改Nginx配置文件</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">        listen 80;  #监听端口</span><br><span class="line">        server_name www.corkercode.com;</span><br><span class="line">        return 301 https://$server_name$request_uri;    #强制把http请求转到https</span><br><span class="line">&#125;</span><br><span class="line">server &#123;</span><br><span class="line">        listen       443 ssl;</span><br><span class="line">        server_name  www.corkercode.com;</span><br><span class="line"></span><br><span class="line">        ssl_certificate      /usr/local/nginx/conf/ssl/1_www.corkercode.com_bundle.crt;   #申请的证书上传到服务器的地址</span><br><span class="line">        ssl_certificate_key  /usr/local/nginx/conf/ssl/2_www.corkercode.com.key;   #申请的证书上传到服务器的地址</span><br><span class="line"></span><br><span class="line">        ssl_session_cache    shared:SSL:1m;</span><br><span class="line">        ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">        ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">        ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            proxy_pass http://132.232.103.84:8090;   #反向代理请求转发到服务器个人网站地址</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>重启Nginx<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ps -ef|grep nginx</span><br><span class="line">kill -9 进程号</span><br><span class="line">/usr/local/nginx/sbin/nginx</span><br></pre></td></tr></table></figure></p><p>测试访问你的域名，会自动转发到https请求！<br>最后删除冗余文件：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /home/nginx-1.15.4.tar.gz</span><br><span class="line">rm -rf /home/nginx-1.15.4</span><br></pre></td></tr></table></figure></p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/nginx-https.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="工具集" scheme="https://www.corkercode.com/categories/%E5%B7%A5%E5%85%B7%E9%9B%86/"/>
    
    
      <category term="nginx" scheme="https://www.corkercode.com/tags/nginx/"/>
    
      <category term="https" scheme="https://www.corkercode.com/tags/https/"/>
    
  </entry>
  
  <entry>
    <title>Sublime Text使用</title>
    <link href="https://www.corkercode.com/2018/09/23/Sublime-Text%E4%BD%BF%E7%94%A8/"/>
    <id>https://www.corkercode.com/2018/09/23/Sublime-Text使用/</id>
    <published>2018-09-23T13:12:21.000Z</published>
    <updated>2019-01-27T16:16:00.015Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/sublime%20text.jpg" alt=""></div><a id="more"></a><p><a href="http://www.yalewoo.com/sublime_text_3_tutorial_1_install.html" target="_blank" rel="noopener">参考1</a></p><p><a href="http://www.MarkdownEditing.com/MarkdownEditing-lee/p/6847906.html" target="_blank" rel="noopener">参考2</a></p><h2 id="1-安装Sublime英文版3"><a href="#1-安装Sublime英文版3" class="headerlink" title="1.安装Sublime英文版3"></a>1.安装Sublime英文版3</h2><p><a href="http://www.sublimetext.com/3" target="_blank" rel="noopener">Sublime官网</a></p><p><strong>Sublime Text 3 最新可用注册码（免破解）</strong></p><p>以下两枚注册码用最新的Sublime Text 3 3162的版本亲测可用。</p><pre><code>—– BEGIN LICENSE SJOLZY.CN —–Anthony SansoneSingle User LicenseEA7E-87856328B9A648 42B99D8A F2E3E9E0 16DE076EE218B3DC F3606379 C33C1526 E8B58964B2CB3F63 BDF901BE D31424D2 082891B5F7058694 55FA46D8 EFC11878 0868F093B17CAFE7 63A78881 86B78E38 0F146238BAE22DBB D4EC71A1 0EC2E701 C7F9C6485CF29CA3 1CB14285 19A46991 E9A9867614FD4777 2D8A0AB6 A444EE0D CA009B54—— END LICENSE ———– BEGIN LICENSE SJOLZY.CN —–Alexey PlutalovSingle User LicenseEA7E-8607763DC19CC1 134CDF23 504DC871 2DE5CE55585DC8A6 253BB0D9 637C87A2 D8D0BA85AAE574AD BA7D6DA9 2B9773F2 324C5DEF17830A4E FBCF9D1D 182406E9 F883EA87E585BBA1 2538C270 E2E857C2 194283CA7234FF9E D0392F93 1D16E021 F191491763909E12 203C0169 3F08FFC8 86D06EA873DDAEF0 AC559F30 A6A67947 B60104C6—— END LICENSE ——</code></pre><h2 id="2-安装Package-Control插件——插件管理器"><a href="#2-安装Package-Control插件——插件管理器" class="headerlink" title="2.安装Package Control插件——插件管理器"></a>2.安装Package Control插件——插件管理器</h2><h3 id="方式一-在线安装"><a href="#方式一-在线安装" class="headerlink" title="方式一  在线安装"></a>方式一  在线安装</h3><pre><code>使用快捷键 Ctrl + ` 调出命令，输入下面代码import urllib.request,os,hashlib; h = &apos;df21e130d211cfc94d9b0905775a7c0f&apos; + &apos;1e3d39e33b79698005270310898eea76&apos;; pf = &apos;Package Control.sublime-package&apos;; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( &apos;http://packagecontrol.io/&apos; + pf.replace(&apos; &apos;, &apos;%20&apos;)).read(); dh = hashlib.sha256(by).hexdigest(); print(&apos;Error validating download (got %s instead of %s), please try manual install&apos; % (dh, h)) if dh != h else open(os.path.join( ipp, pf), &apos;wb&apos; ).write(by)</code></pre><h3 id="方式二-离线手动安装"><a href="#方式二-离线手动安装" class="headerlink" title="方式二  离线手动安装"></a>方式二  离线手动安装</h3><pre><code>Click the Preferences &gt; Browse Packages… menuBrowse up a folder and then into the Installed Packages/ folderDownload Package Control.sublime-package and copy it into the Installed Packages/ directoryRestart Sublime Text</code></pre><h2 id="3-插件"><a href="#3-插件" class="headerlink" title="3.插件"></a>3.插件</h2><pre><code>安装方式    通过菜单Preferneces -&gt; Package Control打开 选择 Install Package     然后输入插件名    1、 ConvertToUTF8  GBK/GB2312中文编码支持    2、Markdown Editing  Markdown编辑插件    3、 MarkdownLivePreview  Markdown实时预览插件    4、Bracket Highlighter　　用于匹配括号，引号和html标签。对于很长的代码很有用。安装好之后，不需要设置插件会自动生效    5、DocBlockr　　DocBlockr可以自动生成PHPDoc风格的注释。它支持的语言有Javascript, PHP, ActionScript, CoffeeScript, Java, Objective C, C, C++    6、Emmet(Zen Coding)　　快速生成HTML代码段的插件，强大到无与伦比，不知道的请自行google    7、Themr　　主题管理，切换主题的时候，不用自己修改配置文件了，用这个可以方便的切换主题</code></pre><h2 id="4-通用快捷键"><a href="#4-通用快捷键" class="headerlink" title="4.通用快捷键"></a>4.通用快捷键</h2><pre><code>1、Ctrl+Shift+P    打开Package Control，上面已经介绍过了。这里还有个技巧，此技巧在下面的各种地方都能用的上，就是ST支持模糊匹配。比如，你想找Install Package，你在 Package Control 的输入框中install，可以自动匹配到Install Package，也可以简单的输入ip，也能匹配到它，这种模糊匹配的功能很方便。    使用Ctrl+鼠标滚轮可以调整字体大小2、Ctrl+P    根据文件名打开文件。比如你想打开login/func/funtion.php，你只要在输入框中输入login/func/funtion.php即可，也可以用模糊匹配，如login/function等，模糊匹配还是自己去体验吧。3、SublimeLinter        = 错误语法4、JsMinifier           =自动压缩js文件5、Sublime CodeIntel    =代码自动提示6、Bracket Highlighter  =代码匹配7、CSScomb CSS          =属性排序8、SublimeTmpl          =快速生成文件模板9、SideBarEnhancements  =设置sublime text2/3支持浏览器预览10、ColorPicker          =调色盘11、Tag                  = Html格式化12、Clipboard History   = 剪贴板历史记录13、SideBarEnhancements = 侧栏右键功能增强14、GBK to UTF8         =GBK转黄成UTF815、SFTP                =ftp插件16、WordPress           = WordPress函数17、PHPTidy             =排版PHP代码18、YUI Compressor      =压缩JS和CSS文件19、Alignment           =代码对齐20、Emmet               =大名鼎鼎呀21、Prefixr             =css自动添加 -webkit 等私有词缀</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/sublime%20text.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="工具集" scheme="https://www.corkercode.com/categories/%E5%B7%A5%E5%85%B7%E9%9B%86/"/>
    
    
      <category term="Sublime Text" scheme="https://www.corkercode.com/tags/Sublime-Text/"/>
    
  </entry>
  
  <entry>
    <title>史上最新最全 Markdown 语法大全</title>
    <link href="https://www.corkercode.com/2018/09/23/%E5%8F%B2%E4%B8%8A%E6%9C%80%E6%96%B0%E6%9C%80%E5%85%A8-Markdown-%E8%AF%AD%E6%B3%95%E5%A4%A7%E5%85%A8/"/>
    <id>https://www.corkercode.com/2018/09/23/史上最新最全-Markdown-语法大全/</id>
    <published>2018-09-23T13:12:21.000Z</published>
    <updated>2019-01-27T16:18:32.508Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/markdown.webp" alt=""></div><a id="more"></a><p>###Markdown基础语法</p><p>####标题<br>支持6种大小的标题，分别对应<code>#</code>,<code>##</code>,<code>###</code>,<code>####</code>,<code>#####</code>,<code>######</code>，和样式文件中的<code>h1,...,h6</code>如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#####H5</span><br><span class="line">######H6</span><br></pre></td></tr></table></figure></p><p>####强调<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">**我是强调**</span><br></pre></td></tr></table></figure></p><p>####斜体<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">试试*斜体*</span><br></pre></td></tr></table></figure></p><p>####强调的斜体<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">试试***强调的斜体***</span><br></pre></td></tr></table></figure></p><p>####删除<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">试试 ~~删除~~</span><br></pre></td></tr></table></figure></p><p>####外链的超链接<br>Markdown 对链接的语法为：<code>[]()</code>,如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[我是外链的超链接](http://www.corkercode.com)</span><br></pre></td></tr></table></figure></p><p>####页内的超链接<br>页内的超链接语法类似外链，只是要在页内增加锚点，如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[我是页内的超链接](#jump_1)</span><br></pre></td></tr></table></figure></p><p>注：你先要在要跳转的到地方放置一个类似：<code>&lt;a id=&quot;jump_1&quot;&gt;任意内容&lt;/a&gt;</code>的锚点。由<code>id=&quot;jump_1&quot;</code>来匹配。</p><p>####图片显示<br>Markdown 对图片链接的语法是:<code>![]()</code>,如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">![图注:zoluo](http://plbhkv0pr.bkt.clouddn.com/wechat-qcode.jpg)</span><br></pre></td></tr></table></figure></p><p><a id="jump_1"></a><br>下图为我的公众号，欢饮关注，获取更多编程与互联网那些事儿。<br><img src="http://upload-images.jianshu.io/upload_images/7269465-73a937b5ec877adc.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="图注:zoluo"><br>注：可直接把网络图片地址添加到markdown中，<br>默认为图片居中，<code>[这里写图片描述]</code>中对图片的描述内容会自动生成在图片的底部。</p><p>####有序列表</p><ol><li>有序列表 1</li><li>有序列表 2</li><li>有序列表 3</li></ol><p>####无序列表</p><ul><li>无序列表 1</li><li>无序列表 2 </li><li>无序列表 3</li></ul><p>####引用块<br>只需要在前面加 <code>&gt;</code>,如下:</p><blockquote><p>我是引用块<br>微信公众号：zoluo<br>欢迎关注我，一起学习，一起进步!</p></blockquote><p>####分隔线</p><hr><p>####行内代码<br>Markdown 对行内代码的语法是前后用：`,其中 ` 为 Windows 键盘左上角那个,如：<code>AppCompatActivity</code>类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`AppCompatActivity`</span><br></pre></td></tr></table></figure></p><p>####代码块<br>Markdown 对代码块的语法是开始和结束行都要添加：```,其中 ` 为windows键盘左上角那个，如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@ApiOperation(&quot;垂深对应值数据中转任务&quot;)</span><br><span class="line">@ApiImplicitParams(@ApiImplicitParam(name = &quot;wellState&quot;, required = true, value = &quot;井状态&quot;, paramType = &quot;query&quot;))</span><br><span class="line">@GetMapping(value = &quot;verticalDepthTask&quot;)</span><br><span class="line">public void verticalDepthTask(String wellState) &#123;</span><br><span class="line">    List&lt;String&gt; jhList = complexBusinessService.getWellNumListByCondition(wellState);</span><br><span class="line">    if (null != jhList &amp;&amp; jhList.size() &gt; 0) &#123;</span><br><span class="line">        for (String jh : jhList) &#123;</span><br><span class="line">            List&lt;Logging&gt; loggingByWellNum = loggingService.getLoggingByWellNum(jh);</span><br><span class="line">            if (null != loggingByWellNum &amp;&amp; loggingByWellNum.size() &gt; 0) &#123;</span><br><span class="line">                loggingService.deleteLoggingByWellNum(jh, 3);</span><br><span class="line">                for (Logging logging : loggingByWellNum) &#123;</span><br><span class="line">                    verticalDepthService.deleteVerticalDepthByLoggingId(logging.getLoggingId());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        complexBusinessService.insertVerticalDepth(jhList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>要精确指定语言（如：<code>java,cpp,css,xml,javascript,python,php,go,kotlin,lua,objectivec</code>等等）时，在头部直接指定，如：```javascript，</p><p>###Markdown扩展语法</p><p>####表格<br>| 班级 | 男生 | 女生 |<br>|—–|—–|——|<br>| 一(7)班 | 30   | 25 |<br>| 一(8)班 | 25   | 30 |</p><p>注：表格在公众号预览时，可能在PC端显示的不是正确的全屏，但在手机上预览时就会正常显示为全屏的了。</p><p>####任务列表</p><ul><li>[x] 任务1，已完成;</li><li>[x] 任务2，已完成;</li><li>[ ] 任务3，未完成; </li></ul><p>####注脚<br>我是注脚[^10]。点点就能知到我跳到了那儿。<br>或跳到放置：<code>&lt;a id=&quot;footnote-10&quot;&gt;任意内容&lt;/a&gt;</code>的地方,[^10] 对应<code>id=&quot;footnote-10&quot;</code></p><p>####TOC<br>看内容目录就是用<code>[toc]</code>生成的<br>注：只要放置:<code>[TOC]</code>,就能把其后面的标题如：<code>#,##,...######</code>自动生成目录树，注意，<code>[TOC]</code>要独立一行，并前面和后面都要空一行</p><p>###直接支持html,css<br>如果你懂html和css，那下面这些效果就不在话下了：</p><p><a href="#jump_1">来个页内跳转</a>，跳转到文未的：<code>&lt;a id=&quot;jump_1&quot;&gt;我是页内跳转到的位置&lt;/a&gt;</code> ,对应：<code>id=&quot;jump_1&quot;</code><br><span style="color: #5bdaed; ">先给点颜色你看看</span><br><span style="color: #AE87FA; ">再给点颜色你看看</span><br><span style="font-size:1.3em;">试试改变字体大小</span><br><span style="font-size:1.3em;font-weight: bold;">改变字体大小，再来个粗体又如何？</span></p><p style="text-align:center"><br>试试内容居中<br></p><p style="text-align:right"><br>那内容居右呢？<br></p><p></p><p style="text-align:center;color:#1e819e;font-size:1.3em;font-weight: bold;"><br>来个综合的试试<br><br><br>第二行<br></p><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">###&lt;span class=&quot;firstletter&quot;&gt;1&lt;/span&gt;试试首字突出</span><br></pre></td></tr></table></figure><p></p><p>###Latex数学公式</p><p>####行内公式：$…$<br>是的，我就是行内公式：$e^{x^2}\neq{e^x}^2$，排得OK吗？</p><p>####块公式：$$…$$<br>$$e^{x^2}\neq{e^x}^2$$<br>来个 <em>“复杂点”</em> 的:<br>$$H(D_2) = -(\frac{2}{4}\ log_2 \frac{2}{4} + \frac{2}{4}\ log_2 \frac{2}{4}) = 1$$<br>矩阵：<br>$$<br>        \begin{pmatrix}<br>        1 &amp; a_1 &amp; a_1^2 &amp; \cdots &amp; a_1^n \<br>        1 &amp; a_2 &amp; a_2^2 &amp; \cdots &amp; a_2^n \<br>        \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots \<br>        1 &amp; a_m &amp; a_m^2 &amp; \cdots &amp; a_m^n \<br>        \end{pmatrix}<br>$$</p><hr><p>本文参考<strong>颜家大少</strong>的作品 <a href="http://md.aclickall.com" target="_blank" rel="noopener">Md2All</a> .</p><hr><p><a id="footnote-1"></a></p><p>###赞赏 zoluo<br>如果你觉得到此文章对你有帮助，欢迎赞赏，有你的支持，是我坚持原创的最大动力！<br><img src="http://upload-images.jianshu.io/upload_images/7269465-b1c91e0cd5992f07.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="zoluo 赞赏码"></p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/markdown.webp&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="工具集" scheme="https://www.corkercode.com/categories/%E5%B7%A5%E5%85%B7%E9%9B%86/"/>
    
    
      <category term="Markdown" scheme="https://www.corkercode.com/tags/Markdown/"/>
    
  </entry>
  
  <entry>
    <title>web常见错误提示</title>
    <link href="https://www.corkercode.com/2018/08/14/web%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E6%8F%90%E7%A4%BA/"/>
    <id>https://www.corkercode.com/2018/08/14/web常见错误提示/</id>
    <published>2018-08-14T14:50:32.000Z</published>
    <updated>2019-01-27T16:15:54.751Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/404.jpg" alt=""></div><a id="more"></a><p>在写web程序的时候，经常会出现一些网页错误的数字提示，如果能够明白这些提示的含义，那对于调试程序是有极大帮助的。网上有很多这方面的总结，但为了适应自己的阅读习惯，以及日后的查找方便，就做了一些修改并总结如下。</p><p>#HTTP 错误 400  400 请求出错<br>由于语法格式有误，服务器无法理解此请求。不作修改，客户程序就无法重复此请求。  HTTP 错误 401<br>401.1 未授权：登录失败<br>此错误表明传输给服务器的证书与登录服务器所需的证书不匹配。<br>请与 Web 服务器的管理员联系，以确认您是否具有访问所请求资源的权限。</p><p>#401.2 未授权：服务器的配置导致登录失败<br>此错误表明传输给服务器的证书与登录服务器所需的证书不匹配。此错误通常由未发送正确的 WWW 验证表头字段所致。<br>请与 Web 服务器的管理员联系，以确认您是否具有访问所请求资源的权限。 </p><p>#401.3 未授权：由于资源中的 ACL 而未授权<br>此错误表明客户所传输的证书没有对服务器中特定资源的访问权限。此资源可能是客户机中的地址行所列出的网页或文件，也可能是处理客户机中的地址行所列出的文件所需服务器上的其他文件。<br>请记录试图访问的完整地址，并与 Web 服务器的管理员联系以确认您是否具有访问所请求资源的权限。  </p><p>#401.4 未授权：授权服务被筛选程序拒绝<br>此错误表明 Web 服务器已经安装了筛选程序，用以验证连接到服务器的用户。此筛选程序拒绝连接到此服务器的真品证书的访问。<br>请记录试图访问的完整地址，并与 Web 服务器的管理员联系以确认您是否具有访问所请求资源的权限。  </p><p>#401.5 未授权：ISAPI/CGI 应用程序的授权失败<br>此错误表明试图使用的 Web服务器中的地址已经安装了 ISAPI 或 CGI程序，在继续之前用以验证用户的证书。此程序拒绝用来连接到服务器的真品证书的访问。  请记录试图访问的完整地址，并与 Web服务器的管理员联系以确认您是否具有访问所请求资源的权限  HTTP 错误 403  </p><p>#403.1 禁止：禁止执行访问<br>如果从并不允许执行程序的目录中执行 CGI、ISAPI或其他执行程序就可能引起此错误。  如果问题依然存在，请与 Web 服务器的管理员联系。  </p><p>#403.2 禁止：禁止读取访问<br>如果没有可用的默认网页或未启用此目录的目录浏览，或者试图显示驻留在只标记为执行或脚本权限的目录中的HTML 页时就会导致此错误。<br>如果问题依然存在，请与 Web 服务器的管理员联系。 </p><p>#403.3 禁止：禁止写访问<br>如果试图上载或修改不允许写访问的目录中的文件，就会导致此问题。  如果问题依然存在，请与 Web服务器的管理员联系。 </p><p>#403.4 禁止：需要 SSL<br>此错误表明试图访问的网页受安全套接字层（SSL）的保护。要查看，必须在试图访问的地址前输入https:// 以启用 SSL。<br>如果问题依然存在，请与 Web服务器的管理员联系。</p><p>#403.5 禁止：需要 SSL 128<br>此错误消息表明您试图访问的资源受 128位的安全套接字层（SSL）保护。要查看此资源，需要有支持此SSL 层的浏览器。<br>请确认浏览器是否支持 128 位 SSL安全性。如果支持，就与 Web服务器的管理员联系，并报告问题。  </p><p>#403.6 禁止：拒绝 IP 地址 </p><p>如果服务器含有不允许访问此站点的 IP地址列表，并且您正使用的 IP地址在此列表中，就会导致此问题。<br>如果问题依然存在，请与 Web服务器的管理员联系。 </p><p>#403.7 禁止：需要用户证书<br>当试图访问的资源要求浏览器具有服务器可识别的用户安全套接字层（SSL）证书时就会导致此问题。可用来验证您是否为此资源的合法用户。<br>请与 Web服务器的管理员联系以获取有效的用户证书。 </p><p>#403.8 禁止：禁止站点访问<br>如果 Web服务器不为请求提供服务，或您没有连接到此站点的权限时，就会导致此问题。  请与 Web 服务器的管理员联系。</p><p>#403.9 禁止访问：所连接的用户太多<br>如果 Web太忙并且由于流量过大而无法处理您的请求时就会导致此问题。请稍后再次连接。  如果问题依然存在，请与 Web 服务器的管理员联系。</p><p>#403.10 禁止访问：配置无效<br>此时 Web 服务器的配置存在问题。<br>如果问题依然存在，请与 Web服务器的管理员联系。</p><p>#403.11 禁止访问：密码已更改<br>在身份验证的过程中如果用户输入错误的密码，就会导致此错误。请刷新网页并重试。  如果问题依然存在，请与 Web服务器的管理员联系。</p><p>#403.12 禁止访问：映射程序拒绝访问  拒绝用户证书试图访问此 Web 站点。<br>请与站点管理员联系以建立用户证书权限。如果必要，也可以更改用户证书并重试。  HTTP 错误 </p><p>#404  404 找不到<br>Web 服务器找不到您所请求的文件或脚本。请检查URL 以确保路径正确。  如果问题依然存在，请与服务器的管理员联系。 </p><p>#HTTP 错误 405  405 不允许此方法<br>对于请求所标识的资源，不允许使用请求行中所指定的方法。请确保为所请求的资源设置了正确的 MIME 类型。<br>如果问题依然存在，请与服务器的管理员联系。</p><p>#HTTP 错误 406 406 不可接受<br>根据此请求中所发送的“接受”标题，此请求所标识的资源只能生成内容特征为“不可接受”的响应实体。  如果问题依然存在，请与服务器的管理员联系。 </p><p>#HTTP 错误 407  </p><p>#407 需要代理身份验证<br>在可为此请求提供服务之前，您必须验证此代理服务器。请登录到代理服务器，然后重试。  如果问题依然存在，请与 Web 服务器的管理员联系。 </p><p>#HTTP 错误 412  412 前提条件失败<br>在服务器上测试前提条件时，部分请求标题字段中所给定的前提条件估计为FALSE。客户机将前提条件放置在当前资源 metainformation（标题字段数据）中，以防止所请求的方法被误用到其他资源。  如果问题依然存在，请与 Web 服务器的管理员联系。 </p><p>#HTTP 错误 414<br>414 Request-URI 太长<br>Request-URL太长，服务器拒绝服务此请求。仅在下列条件下才有可能发生此条件：  客户机错误地将 POST 请求转换为具有较长的查询信息的 GET 请求。  客户机遇到了重定向问题（例如，指向自身的后缀的重定向前缀）。<br>服务器正遭受试图利用某些服务器（将固定长度的缓冲区用于读取或执行 Request-URI）中的安全性漏洞的客户干扰。<br>如果问题依然存在，请与 Web 服务器的管理员联系。  </p><p>#HTTP 错误 500<br>500 服务器的内部错误<br>Web 服务器不能执行此请求。请稍后重试此请求。  如果问题依然存在，请与 Web服务器的管理员联系。  </p><p>#HTTP 错误 501  501 未实现<br>Web 服务器不支持实现此请求所需的功能。请检查URL 中的错误，如果问题依然存在，请与 Web服务器的管理员联系。 </p><p>#HTTP 错误 502  502 网关出错<br>当用作网关或代理时，服务器将从试图实现此请求时所访问的upstream 服务器中接收无效的响应。  如果问题依然存在，请与 Web服务器的管理员联系。</p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/404.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="Java 编程思想" scheme="https://www.corkercode.com/categories/Java-%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3/"/>
    
    
      <category term="java" scheme="https://www.corkercode.com/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>Hexo博客建站六〈彩蛋〉</title>
    <link href="https://www.corkercode.com/2018/07/14/Hexo%E5%8D%9A%E5%AE%A2%E5%BB%BA%E7%AB%99%E5%85%AD%E3%80%88%E5%BD%A9%E8%9B%8B%E3%80%89/"/>
    <id>https://www.corkercode.com/2018/07/14/Hexo博客建站六〈彩蛋〉/</id>
    <published>2018-07-14T05:40:34.000Z</published>
    <updated>2019-01-27T16:15:00.470Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-26_14-20-01.png" alt="zoluo 个人博客"></div><a id="more"></a><blockquote><p>最后放个大招，我的 <a href="https://www.corkercode.com">个人博客地址</a>,是不是还可以啊！<br>贴上我的自定义样式代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br></pre></td><td class="code"><pre><span class="line">// Custom styles.</span><br><span class="line">//顶部条</span><br><span class="line">.headband &#123;</span><br><span class="line">  height: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//背景图</span><br><span class="line">body &#123;</span><br><span class="line">    background-image: url(http://plbhkv0pr.bkt.clouddn.com/background.jpg);</span><br><span class="line">    background-attachment: fixed; // 不随屏幕滚动而滚动fixed,scroll,inherit</span><br><span class="line">    background-repeat: no-repeat; // 如果背景图不够屏幕大小则重复铺，改为no-repeat则表示不重复铺</span><br><span class="line">    background-size: cover; // contain等比例铺满屏幕 //cover拉伸铺满</span><br><span class="line">    background-position: bottom;//x,y轴调整</span><br><span class="line">    +mobile()&#123;</span><br><span class="line">      //background-position: 0% -20%;</span><br><span class="line">      background-image: linear-gradient(90deg, #F79533 0%, #F37055 15%, #EF4E7B 30%, #A166AB 44%, #5073B8 58%, #1098AD 72%, #07B39B 86%, #6DBA82 100%);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//首部背景url(http://plbhkv0pr.bkt.clouddn.com/header.jpg)</span><br><span class="line">//彩色linear-gradient(90deg, #F79533 0%, #F37055 15%, #EF4E7B 30%, #A166AB 44%, #5073B8 58%, #1098AD 72%, #07B39B 86%, #6DBA82 100%)</span><br><span class="line">.site-meta &#123;</span><br><span class="line">    height: 100px;</span><br><span class="line">    background-image: url(http://plbhkv0pr.bkt.clouddn.com/header.jpg);</span><br><span class="line">    background-size: cover;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//侧边栏信息样式修改</span><br><span class="line">/*.links-of-blogroll-item &#123;</span><br><span class="line">  padding: 0 8px;</span><br><span class="line">  background-color: #50842e;</span><br><span class="line">  border-radius: 4px;</span><br><span class="line">&#125;</span><br><span class="line">.links-of-blogroll-item a &#123;</span><br><span class="line">  color: #fff;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  display: inline;</span><br><span class="line">&#125;*/</span><br><span class="line"></span><br><span class="line">//</span><br><span class="line">.header-inner &#123;</span><br><span class="line">  background: rgba(255,255,255,0.7)</span><br><span class="line">  border-radius: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//侧栏</span><br><span class="line">.sidebar&#123;</span><br><span class="line">  background: none;</span><br><span class="line">  border-radius: 10px;</span><br><span class="line">&#125;</span><br><span class="line">.sidebar-inner &#123;</span><br><span class="line">  padding: 10px 10px 10px;</span><br><span class="line">  background: rgba(255,255,255,0.7)</span><br><span class="line">  border-radius: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">code &#123;</span><br><span class="line">    color: #ff7600;</span><br><span class="line">    background: #fbf7f8;</span><br><span class="line">    margin: 2px;</span><br><span class="line">&#125;</span><br><span class="line">// 大代码块的自定义样式</span><br><span class="line">.highlight, pre &#123;</span><br><span class="line">    margin: 5px 0;</span><br><span class="line">    padding: 5px;</span><br><span class="line">    border-radius: 3px;</span><br><span class="line">&#125;</span><br><span class="line">.highlight, code, pre &#123;</span><br><span class="line">    border: 1px solid #d6d6d6;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//夜间模式</span><br><span class="line">.cover&#123;</span><br><span class="line">    position:fixed;</span><br><span class="line">    top: 0px;</span><br><span class="line">    left: 0px;</span><br><span class="line">    outline:5000px solid rgba(0, 0, 0, 0);</span><br><span class="line">    z-index: 99999;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//沐目体</span><br><span class="line">@font-face &#123;</span><br><span class="line"> font-family: MMT;</span><br><span class="line"> src: url(&quot;/media/MMT_579767_SOAJ0_0.ttf&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@font-face &#123;</span><br><span class="line"> font-family: STLiti;</span><br><span class="line"> src: url(&quot;/media/STLITI.TTF&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@font-face &#123;</span><br><span class="line"> font-family: STXK;</span><br><span class="line"> src: url(&quot;/media/STXINGKA.TTF&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//输入框美化</span><br><span class="line">input &#123;</span><br><span class="line">    border: 1px solid #ccc;</span><br><span class="line">    padding: 5px 0px;</span><br><span class="line">    border-radius: 3px;</span><br><span class="line">    padding-left: 5px;</span><br><span class="line">    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);</span><br><span class="line">    box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);</span><br><span class="line">    -webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow</span><br><span class="line">        ease-in-out .15s;</span><br><span class="line">    -o-transition: border-color ease-in-out .15s, box-shadow ease-in-out</span><br><span class="line">        .15s;</span><br><span class="line">    transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">input:focus &#123;</span><br><span class="line">    border-color: #66afe9;</span><br><span class="line">    outline: 0;</span><br><span class="line">    -webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 8px</span><br><span class="line">        rgba(102, 175, 233, .6);</span><br><span class="line">    box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075), 0 0 8px</span><br><span class="line">        rgba(102, 175, 233, .6)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//文章页内标签样式</span><br><span class="line">.posts-expand .post-tags &#123;</span><br><span class="line">  margin: 40px 10px 0 10px;</span><br><span class="line">  text-align: right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.posts-expand .post-tags a &#123;</span><br><span class="line">  -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);</span><br><span class="line">  -moz-box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);</span><br><span class="line">  box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);</span><br><span class="line">  font-family: &apos;Comic Sans MS&apos;, sans-serif;</span><br><span class="line">  transition: 0.2s ease-out;</span><br><span class="line">  padding: 3px 5px;</span><br><span class="line">  margin: 5px;</span><br><span class="line">  background: #eee;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  border-radius: 15px;</span><br><span class="line"></span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">  background: rgba(100,154,182,0.902);</span><br><span class="line">  color: #fff;</span><br><span class="line">  -webkit-box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">  -moz-box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.tag-cloud a &#123;</span><br><span class="line">  -webkit-box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);</span><br><span class="line">  -moz-box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);</span><br><span class="line">  box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);</span><br><span class="line">  transition: 0.2s ease-out;</span><br><span class="line">  padding: 2px 10px;</span><br><span class="line">  margin: 8px;</span><br><span class="line">  background: #eee;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  border-radius: 12px;</span><br><span class="line"></span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">  text-decoration: none;</span><br><span class="line">  background: rgba(100,154,182,0.902);</span><br><span class="line">  color: #fff !important;</span><br><span class="line">  -webkit-box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">  -moz-box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">  box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//文章标题</span><br><span class="line">.posts-expand .post-title &#123;</span><br><span class="line">  font-size: 21px</span><br><span class="line">  border-left: #649ab6 2px solid;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  padding-left: 10px;</span><br><span class="line">&#125;</span><br><span class="line">.posts-expand .post-title, .posts-expand .post-meta &#123;</span><br><span class="line">  text-align: left;</span><br><span class="line">&#125;</span><br><span class="line">.page-post-detail .post-title, .page-post-detail .post-meta &#123;</span><br><span class="line">  text-align: center;</span><br><span class="line">  border-left: none;</span><br><span class="line">  padding-left: 0;</span><br><span class="line">&#125;</span><br><span class="line">.posts-expand .post-title-link&#123;</span><br><span class="line">  line-height: 1.5;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//修改默认按钮样式#bdc3c7</span><br><span class="line">.post-button &#123;</span><br><span class="line">  text-align: right;</span><br><span class="line">&#125;</span><br><span class="line">.btn &#123;</span><br><span class="line">  padding: 3px 15px</span><br><span class="line">  color: #000 !important;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  border: 0px;</span><br><span class="line">  border-radius: 15px;</span><br><span class="line"></span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    color: #fff !important;</span><br><span class="line">    background: #34495e;</span><br><span class="line">    text-decoration: none !important;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//页码栏</span><br><span class="line">.pagination, .pagination .prev, .pagination .next, .pagination .page-number &#123;</span><br><span class="line">  border:none;</span><br><span class="line">&#125;</span><br><span class="line">.pagination .page-number.current &#123;</span><br><span class="line">  border-radius: 14px;</span><br><span class="line">  background: #34495e;</span><br><span class="line">&#125;</span><br><span class="line">.pagination &#123;</span><br><span class="line">  margin: 60px 0 20px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//去掉图片边框</span><br><span class="line">.posts-expand .post-body img &#123;</span><br><span class="line">    border: 0px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//文章样式修改</span><br><span class="line">.content-wrap &#123;</span><br><span class="line">  border-radius: 10px;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    border-radius: 0px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 文章内链接文本样式</span><br><span class="line">.post-body p a&#123;</span><br><span class="line">  color: #7B68EE;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  border-bottom: 1px solid #0593d3;</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    color: #fc6423;</span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-bottom: 1px solid #fc6423;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">//文章阴影</span><br><span class="line">.post, .page, .post-block &#123;</span><br><span class="line">  margin-bottom: 40px;</span><br><span class="line">  padding: 20px 20px 20px;</span><br><span class="line">  -webkit-box-shadow: 0 0 14px #cacbcb;</span><br><span class="line">  -moz-box-shadow: 0 0 14px #cacbcb;</span><br><span class="line">  box-shadow: 0 0 14px #cacbcb;</span><br><span class="line">  background: rgba(255,255,255,0.6)</span><br><span class="line">  border-radius: 10px;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    margin-bottom: 0px;</span><br><span class="line">    padding: 0px 0px 0px;</span><br><span class="line">    -webkit-box-shadow: 0 0 0px rgba(255,255,255,0);</span><br><span class="line">    -moz-box-shadow: 0 0 0px rgba(255,255,255,0);</span><br><span class="line">    box-shadow: 0 0 0px rgba(255,255,255,0);</span><br><span class="line">    background: rgba(255,255,255,0)</span><br><span class="line">    border-radius: 0px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.posts-expand .post-eof &#123;</span><br><span class="line">  display: block;</span><br><span class="line">  margin: 0px auto 30px;</span><br><span class="line">  width: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//评论区</span><br><span class="line">.comments&#123;</span><br><span class="line">  padding: 20px 20px 20px;</span><br><span class="line">  -webkit-box-shadow: 0 0 14px #cacbcb;</span><br><span class="line">  -moz-box-shadow: 0 0 14px #cacbcb;</span><br><span class="line">  box-shadow: 0 0 14px #cacbcb;</span><br><span class="line">  background: rgba(255,255,255,0.7);</span><br><span class="line">  margin: 0;</span><br><span class="line">  border-radius: 10px;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    margin-bottom: 0px;</span><br><span class="line">    padding: 0px 0px 0px;</span><br><span class="line">    -webkit-box-shadow: 0 0 0px rgba(255,255,255,0);</span><br><span class="line">    -moz-box-shadow: 0 0 0px rgba(255,255,255,0);</span><br><span class="line">    box-shadow: 0 0 0px rgba(255,255,255,0);</span><br><span class="line">    background: rgba(255,255,255,0)</span><br><span class="line">    border-radius: 0px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p></blockquote>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-26_14-20-01.png&quot; alt=&quot;zoluo 个人博客&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="个人博客" scheme="https://www.corkercode.com/categories/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://www.corkercode.com/tags/hexo/"/>
    
      <category term="next" scheme="https://www.corkercode.com/tags/next/"/>
    
  </entry>
  
  <entry>
    <title>Hexo博客建站五〈天阶配置〉</title>
    <link href="https://www.corkercode.com/2018/07/14/Hexo%E5%8D%9A%E5%AE%A2%E5%BB%BA%E7%AB%99%E4%BA%94%E3%80%88%E5%A4%A9%E9%98%B6%E9%85%8D%E7%BD%AE%E3%80%89/"/>
    <id>https://www.corkercode.com/2018/07/14/Hexo博客建站五〈天阶配置〉/</id>
    <published>2018-07-14T05:35:10.000Z</published>
    <updated>2019-01-27T16:16:41.813Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/hexo-all.png" alt=""></div><a id="more"></a><blockquote><p>接上一篇<a href="">地阶配置</a></p></blockquote><p>###天阶配置</p><ol><li>评论系统<br>Next 主题支持多种评论系统，如：来必力、多说、Valine，这里我使用 <a href="https://valine.js.org/" target="_blank" rel="noopener">Valine</a>，个人感觉使用比较流畅。<br>注册 Leancloud ，我们的评论系统其实是放在 Leancloud 上的，因此首先需要去注册一个账号，<a href="https://leancloud.cn" target="_blank" rel="noopener">Leancloud官网，点我注册</a>。<br>注册完以后需要创建一个应用，名字可以随便起，然后 进入应用-&gt;设置-&gt;应用key，如下：<br><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-26_00-49-29.png" alt="Leancloud key"><br>拿到你的appid和appkey之后，打开主题配置文件 搜索 valine，填入appid 和 appkey:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Valine.</span><br><span class="line"># You can get your appid and appkey from https://leancloud.cn</span><br><span class="line"># more info please open https://valine.js.org</span><br><span class="line">valine:</span><br><span class="line">  enable: true</span><br><span class="line">  appid:  ······</span><br><span class="line">  appkey:  ······</span><br><span class="line">  notify: false # mail notifier , https://github.com/xCss/Valine/wiki</span><br><span class="line">  verify: false # Verification code</span><br><span class="line">  placeholder: Just go go # comment box placeholder</span><br><span class="line">  avatar: mp # gravatar style</span><br><span class="line">  guest_info: nick,mail,link # custom comment header</span><br><span class="line">  pageSize: 10 # pagination size</span><br></pre></td></tr></table></figure></li></ol><p><strong>注：记得在Leancloud -&gt; 设置 -&gt; 安全中心 -&gt; Web 安全域名 把你的域名加进去</strong></p><ol start="2"><li>DaoVoice 在线联系<br>(1) 首先到 <a href="http://www.daovoice.io/" target="_blank" rel="noopener">DaoVoice</a> 注册账号，支持github、微信注册，开启DaoVoice之旅。<br>注册完后登录，进入到 后台管理，点击 应用设置——&gt;安装到网站 查看安装代码和AppID。<br><strong>注：注册时需要邀请码，这里提供一个<code>1e963cbc</code>.</strong><br>(2) 将安装代码添加到<code>/themes/next/layout/_partials/head.swig</code>中:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.daovoice %&#125;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">  (function(i,s,o,g,r,a,m)&#123;i[&quot;DaoVoiceObject&quot;]=r;i[r]=i[r]||function()&#123;(i[r].q=i[r].q||[]).push(arguments)&#125;,i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset=&quot;utf-8&quot;;m.parentNode.insertBefore(a,m)&#125;)(window,document,&quot;script&quot;,(&apos;https:&apos; == document.location.protocol ? &apos;https:&apos; : &apos;http:&apos;) + &quot;//widget.daovoice.io/widget/0f81ff2f.js&quot;,&quot;daovoice&quot;)</span><br><span class="line">  daovoice(&apos;init&apos;, &#123;</span><br><span class="line">      app_id: &quot;&#123;&#123;theme.daovoice_app_id&#125;&#125;&quot;</span><br><span class="line">    &#125;);</span><br><span class="line">  daovoice(&apos;update&apos;);</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure></li></ol><p><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-26_00-22-21.png" alt="DaoVoice 配置"><br>(3) 编辑主题配置文件，再末尾添加如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># Online contact </span><br><span class="line">daovoice: true</span><br><span class="line">daovoice_app_id: b2f59f80</span><br></pre></td></tr></table></figure></p><p><strong>注：这里 DaoVoice 其实可以接入微信接受消息的，但是要求是公众号必须是认证后的，因此个人公众号就急急了！</strong></p><ol start="3"><li>分享功能<br>在next主题的官方的文档中发现它自身集成了百度分享的功能，所以决定采用百度了。<br>这里需要用到 ShareSDK 因此我们得注册一下下 <a href="http://www.mob.com/" target="_blank" rel="noopener">ShareSDK注册</a>，获取到我们 appkey<br>修改主题配置文件如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#Share</span><br><span class="line">sharesdk: true</span><br><span class="line">shareSDKappkey: cc1fb1a0053a</span><br><span class="line"># Baidu Share</span><br><span class="line"># Available value:</span><br><span class="line">#    button | slide</span><br><span class="line"># Warning: Baidu Share does not support https.</span><br><span class="line">baidushare: </span><br><span class="line">  type: slide</span><br><span class="line">  baidushare: true</span><br></pre></td></tr></table></figure></li></ol><p><strong>注：sharesdk 使用起来并不美观，而百度分享现在对 HTTPS 的支持又不友好，所以我放弃了使用这样的分享方式。大家如果觉得我写的文章还不错，就多推荐下就行了。</strong></p><ol start="4"><li>Hexo 绑定 Https 域名<blockquote><p>你的网站的域名是你的网站的第一印象，为你的网站选择一个域名就如同给你自己选择名字一样重要。你不仅需要选择一个跟你息息相关，跟你的网站相配的域名，同时也要容易被搜到并且容易推广。<br>因此 <a href="https://www.zoompoint.net/choose-domain-tips/" target="_blank" rel="noopener">选择一个完美域名的10个建议</a> 送给你。<br>这里我的域名只是暂时随便买了个，等到期了，换一个有印象的，大家别质疑我目前的域名额。</p></blockquote></li></ol><p>Hexo 配置域名以及 Https 网上教程很杂乱，我 Google 了下，找到了最简洁快速的方式，秒生效，儿豁你！<br>前面我们提到过准备好自己的域名，下面就是配置的重要事项了：</p><p>(1) 注册<strong>netlify</strong>账号<br>到 <a href="https://www.netlify.com/" target="_blank" rel="noopener">Netlify</a> 注册账号并登录<br>(2) 配置域名<br>点击页面右上角的 New site from Git，再 Create a new site<br><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-26_02-30-29.png" alt="Create a new site"><br>然后选择 GitHub 选择自己<code>username.github.io</code>的仓库，直接 Deploy site。<br>点击 Domain settings 然后点击 Add custom domain，后按照提示输入你的域名如<code>www.corkercode.com</code>，最后 save。<br>(3) 解析域名<br>配置好域名后如下图，在三个红色区域有三条加了黄色感叹号的<code>DNS</code>提示，我们可以点击查看。<br><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-26_03-02-22.png" alt="Custom domains"><br>然后到域名解析处,修改域名CNAME记录,记录值就是你上面点击看到显示的配置值，下面是我的配置<br><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-26_03-06-23.png" alt="域名解析"><br>当你解析成功后，上面的黄色感叹号提示会消失，且在下方会出现以下标识，代表你配置完了，此时你可以用 Https 访问的网站了。<br><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-26_03-12-19.png" alt="Https 配置成功"><br>(3) Https 配置成功<br>此时，恭喜你离成功还差半步，如果正常条件下的话，你应该会看到小绿锁（代表配置成功了）。<br>然而一般还差一步，就是你网站内的内容存在不安全地址（就是有 http 的请求，一般是图片之类的），所以我们得修改图床的 HTTPS 配置了，当然你如果是使用的站内图片那就没问题了。</p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/hexo-all.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="个人博客" scheme="https://www.corkercode.com/categories/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://www.corkercode.com/tags/hexo/"/>
    
      <category term="next" scheme="https://www.corkercode.com/tags/next/"/>
    
  </entry>
  
  <entry>
    <title>Hexo博客建站四〈地阶配置〉</title>
    <link href="https://www.corkercode.com/2018/07/14/Hexo%E5%8D%9A%E5%AE%A2%E5%BB%BA%E7%AB%99%E5%9B%9B%E3%80%88%E5%9C%B0%E9%98%B6%E9%85%8D%E7%BD%AE%E3%80%89/"/>
    <id>https://www.corkercode.com/2018/07/14/Hexo博客建站四〈地阶配置〉/</id>
    <published>2018-07-14T05:34:27.000Z</published>
    <updated>2019-01-27T16:16:46.082Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/hexo-678x381.png" alt=""></div><a id="more"></a><blockquote><p>接上一篇<a href="">玄阶配置</a></p></blockquote><p>###地阶配置<br>这部分的配置由作者们自由选择了，网上有很多方案，这里我采用的是配置起来比较简单的一种，可参考使用。</p><ol><li>网站背景<br>这里有两种方式，第一种是 Next 主题自带的动态背景，只需修改主题配置文件即可：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># Canvas-nest</span><br><span class="line">canvas_nest: true</span><br></pre></td></tr></table></figure></li></ol><p>第二种方式就是自己添加背景图片，这种方式的自己写<code>css</code>代码，不过我已经写好了，拿去用就行了，<br>在<code>\themes\next\source\css\_custom</code>目录下，有<code>custom.styl</code>文件，这里可以放置我们自定义的一些样式，我们先添加一个背景图：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// Custom styles.</span><br><span class="line">//顶部条</span><br><span class="line">.headband &#123;</span><br><span class="line">  height: 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//背景图</span><br><span class="line">body &#123;</span><br><span class="line">    background-image: url(http://plbhkv0pr.bkt.clouddn.com/background.jpg);</span><br><span class="line">    background-attachment: fixed; // 不随屏幕滚动而滚动fixed,scroll,inherit</span><br><span class="line">    background-repeat: no-repeat; // 如果背景图不够屏幕大小则重复铺，改为no-repeat则表示不重复铺</span><br><span class="line">    background-size: cover; // contain等比例铺满屏幕 //cover拉伸铺满</span><br><span class="line">    background-position: bottom;//x,y轴调整</span><br><span class="line">    +mobile()&#123;</span><br><span class="line">      //background-position: 0% -20%;</span><br><span class="line">      background-image: linear-gradient(90deg, #F79533 0%, #F37055 15%, #EF4E7B 30%, #A166AB 44%, #5073B8 58%, #1098AD 72%, #07B39B 86%, #6DBA82 100%);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><ol start="2"><li>实现 fork me on github<br>在 <a href="https://github.blog/2008-12-19-github-ribbons/" target="_blank" rel="noopener">GitHub Ribbons</a> 或 <a href="http://tholman.com/github-corners/" target="_blank" rel="noopener">GitHub Corners</a> 选择一款你喜欢的挂饰，拷贝方框内的代码,如下：<br><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-25_22-13-38.png" alt="fork me on github"><br>将刚刚复制的挂饰代码，添加到<code>/themes/next/layout/_layout.swig</code>文件中，添加位置如下图所示(放在<code>&lt;div class=&quot;headband&quot;&gt;&lt;/div&gt;</code>下方)：<br><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-25_22-17-18.png" alt="fork me on github"><br><strong>注：挂饰代码的<code>&lt;a href=&quot;https://https://github.com/zoluoc&quot;</code>这个链接改写成自己 GitHub 地址！</strong></li><li>文章末尾添加“文章结束”标记<br>(1) 在路径<code>\themes\next\layout\_macro</code>文件夹中新建<code>passage-end-tag.swig</code>文件;<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//切换到路径_macro</span><br><span class="line">cd [_macro路径]</span><br><span class="line"></span><br><span class="line">//创建passage-end-tag.swig文件</span><br><span class="line">touch passage-end-tag.swig</span><br></pre></td></tr></table></figure></li></ol><p>(2) 在<code>passage-end-tag.swig</code>添加以下内容，粘贴以下内容后保存:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">    &#123;% if not is_index %&#125;</span><br><span class="line">        &lt;div style=&quot;text-align:center;color: #ccc;font-size:14px;&quot;&gt;-------------本文结束&lt;i class=&quot;far fa-grin-tongue&quot;&gt;&lt;/i&gt;感谢您的阅读-------------&lt;/div&gt;</span><br><span class="line">    &#123;% endif %&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p><p>(3) 打开<code>\themes\next\layout\_macro\post.swig</code>文件，在<code>END POST BODY</code>之后，添加以下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  &#123;% if not is_index %&#125;</span><br><span class="line">    &#123;% include &apos;passage-end-tag.swig&apos; %&#125;</span><br><span class="line">  &#123;% endif %&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p><p>添加位置如下图：<br><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_2019-01-25_22-40-28.png" alt="文章结束标记"><br>(4) 修改主题配置文件<code>_config.yml</code>，在末尾添加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 文章末尾添加“本文结束”标记</span><br><span class="line">passage_end_tag:</span><br><span class="line">  enabled: true</span><br></pre></td></tr></table></figure></p><ol start="4"><li><p>头像画圆旋转<br>打开<code>/themes/next/source/css/_common/components/sidebar/sidebar-author.styl</code>，添加以下代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">.site-author-image &#123;</span><br><span class="line">  display: block;</span><br><span class="line">  margin: 0 auto;</span><br><span class="line">  padding: $site-author-image-padding;</span><br><span class="line">  max-width: $site-author-image-width;</span><br><span class="line">  height: $site-author-image-height;</span><br><span class="line">  border: $site-author-image-border-width solid $site-author-image-border-color;</span><br><span class="line">  border-radius: 60%;</span><br><span class="line">  transition: 2.5s all;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.site-author-image:hover &#123;</span><br><span class="line">    transform: rotate(360deg);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">.site-author-name &#123;</span><br><span class="line">  margin: $site-author-name-margin;</span><br><span class="line">  text-align: $site-author-name-align;</span><br><span class="line">  color: $site-author-name-color;</span><br><span class="line">  font-weight: $site-author-name-weight;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.site-description &#123;</span><br><span class="line">  margin-top: $site-description-margin-top;</span><br><span class="line">  text-align: $site-description-align;</span><br><span class="line">  font-size: $site-description-font-size;</span><br><span class="line">  color: $site-description-color;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>修改代码块样式<br>打开<code>\themes\next\source\css\_custom\custom.styl</code>，添加以下代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">code &#123;</span><br><span class="line">    color: #ff7600;</span><br><span class="line">    background: #fbf7f8;</span><br><span class="line">    margin: 2px;</span><br><span class="line">&#125;</span><br><span class="line">// 大代码块的自定义样式</span><br><span class="line">.highlight, pre &#123;</span><br><span class="line">    margin: 5px 0;</span><br><span class="line">    padding: 5px;</span><br><span class="line">    border-radius: 3px;</span><br><span class="line">&#125;</span><br><span class="line">.highlight, code, pre &#123;</span><br><span class="line">    border: 1px solid #d6d6d6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>侧边栏社交小图标设置<br>打开主题配置文件<code>_config.yml</code>，搜索<code>Social</code>，将你有的社交账号前面的<code>#</code>号去，格式为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[社交平台名]: [社交地址] || [图标名称]</span><br></pre></td></tr></table></figure></li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">social:</span><br><span class="line">  GitHub: https://github.com/zoluoc || github</span><br><span class="line">  简书: https://www.jianshu.com/u/aa9caab6cf80 || heartbeat</span><br><span class="line">  # E-Mail: mailto:yourname@gmail.com || envelope</span><br><span class="line">  #Google: https://plus.google.com/yourname || google</span><br></pre></td></tr></table></figure><ol start="7"><li><p>左侧栏头部使用图片背景<br>打开<code>\themes\next\source\css\_custom\custom.styl</code>，添加以下代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//首部背景url(http://plbhkv0pr.bkt.clouddn.com/header.jpg)</span><br><span class="line">.site-meta &#123;</span><br><span class="line">    height: 100px;</span><br><span class="line">    background-image: url(http://plbhkv0pr.bkt.clouddn.com/header.jpg);</span><br><span class="line">    background-size: cover;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>赞赏支持<br>获取微信和支付宝等收款二维码图片，上传到图床或者博客本地<code>\source\uploads</code>目录下<br>在主题配置文件下修改以下代码：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># Reward</span><br><span class="line">reward_comment: 坚持原创技术分享，您的支持将鼓励我继续创作！</span><br><span class="line">wechatpay: http://plbhkv0pr.bkt.clouddn.com/wechatpay.png</span><br><span class="line">alipay: http://plbhkv0pr.bkt.clouddn.com/alipay.jpg</span><br><span class="line">``` </span><br><span class="line">9. 网站底部加上访问量及文章阅读量</span><br><span class="line">这个`Next5.0`版本以后就帮我们集成了`busuanzi`统计了，只需修改主题配置文件的`busuanzi_count`属性，如下：</span><br></pre></td></tr></table></figure></li></ol><p>busuanzi_count:</p><h1 id="count-values-only-if-the-other-configs-are-false"><a href="#count-values-only-if-the-other-configs-are-false" class="headerlink" title="count values only if the other configs are false"></a>count values only if the other configs are false</h1><p>  enable: true</p><h1 id="custom-uv-span-for-the-whole-site"><a href="#custom-uv-span-for-the-whole-site" class="headerlink" title="custom uv span for the whole site"></a>custom uv span for the whole site</h1><p>  site_uv: true<br>  site_uv_header: 访客数<br>  site_uv_footer: 人次</p><h1 id="custom-pv-span-for-the-whole-site"><a href="#custom-pv-span-for-the-whole-site" class="headerlink" title="custom pv span for the whole site"></a>custom pv span for the whole site</h1><p>  site_pv: true<br>  site_pv_header: 访问量<br>  site_pv_footer: 次</p><h1 id="custom-pv-span-for-one-page-only"><a href="#custom-pv-span-for-one-page-only" class="headerlink" title="custom pv span for one page only"></a>custom pv span for one page only</h1><p>  page_pv: true<br>  page_pv_header: 阅读量<br>  page_pv_footer: 次<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">**注：不蒜子统计的域名过期问题：修改`/theme/next/layout/_third-party/analytics/busuanzi-counter.swig文件`，替换路径为https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js**</span><br><span class="line">10. 博客总字数统计</span><br><span class="line">切换到更目录，安装以下插件：</span><br></pre></td></tr></table></figure></p><p>npm install hexo-wordcount –save<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在`/themes/next/layout/_partials/footer.swig`末尾添加代码：</span><br><span class="line">```html</span><br><span class="line">&lt;div class=&quot;theme-info&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;powered-by&quot;&gt;&lt;/div&gt;</span><br><span class="line">  &lt;span class=&quot;post-count&quot;&gt;全站共&#123;&#123; totalcount(site) &#125;&#125;字&lt;/span&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p><p><strong>注：这里 Markdown 语法必须写 html，不然 Hexo 编译生成时会报错。</strong></p><ol start="11"><li><p>文章统计功能<br>安装Hexo插件，参考<strong>博客总字数统计</strong><br>编辑主题配置文件，配置如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">post_wordcount:</span><br><span class="line">  item_text: true</span><br><span class="line">  wordcount: true</span><br><span class="line">  min2read: true</span><br><span class="line">  totalcount: false</span><br><span class="line">  separated_meta: true</span><br></pre></td></tr></table></figure></li><li><p>博客图标 Favicon<br>每个网站都有自己的图标，自己的博客当然也不列外，图标可以在网上找，这里提供以下两个网站 <a href="https://www.easyicon.net/" target="_blank" rel="noopener">easyicon</a> 和 <a href="https://www.iconfont.cn/" target="_blank" rel="noopener">阿里巴巴矢量图标库</a>，当然也可以自己制作。<br>要求是两张图（大：32x32 小：16x16）的矢量图，准备好图片后放在<code>/themes/next/source/images</code>，将默认的两张图片替换掉。命名和默认的一样也可以自己定义。</p></li></ol><p>修改主题配置文件，如果你自定义了图片名字，需要做修改：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">favicon:</span><br><span class="line">  small: /images/favicon-16x16-next.png</span><br><span class="line">  medium: /images/favicon-32x32-next.png</span><br><span class="line">  apple_touch_icon: /images/apple-touch-icon-next.png</span><br><span class="line">  safari_pinned_tab: /images/logo.svg</span><br></pre></td></tr></table></figure></p><ol start="13"><li><p>网页顶部进度加载条<br>编辑主题配置文件，搜索<code>pace</code>，将其值改为<code>ture</code>就可以了，再选择一款你喜欢的样式。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">pace: true</span><br><span class="line"># Themes list:</span><br><span class="line">#pace-theme-big-counter</span><br><span class="line">#pace-theme-bounce</span><br><span class="line">#pace-theme-barber-shop</span><br><span class="line">#pace-theme-center-atom</span><br><span class="line">#pace-theme-center-circle</span><br><span class="line">#pace-theme-center-radar</span><br><span class="line">#pace-theme-center-simple</span><br><span class="line">#pace-theme-corner-indicator</span><br><span class="line">#pace-theme-fill-left</span><br><span class="line">#pace-theme-flash</span><br><span class="line">#pace-theme-loading-bar</span><br><span class="line">#pace-theme-mac-osx</span><br><span class="line">#pace-theme-minimal</span><br><span class="line"># For example</span><br><span class="line"># pace_theme: pace-theme-center-simple</span><br><span class="line">pace_theme: pace-theme-minimal</span><br></pre></td></tr></table></figure></li><li><p>隐藏底部<strong>由Hexo强力驱动、主题–NexT.Mist</strong><br>打开<code>/themes/next/layout/_partials/footer.swig</code>，注释掉相应代码:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">//用下面的符号注释，注释代码用下面括号括起来</span><br><span class="line">&lt;!-- --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!--</span><br><span class="line">&lt;span class=&quot;post-meta-divider&quot;&gt;|&lt;/span&gt;</span><br><span class="line"></span><br><span class="line">&#123;% if theme.footer.powered %&#125;</span><br><span class="line">  &lt;div class=&quot;powered-by&quot;&gt;&#123;#</span><br><span class="line">  #&#125;&#123;&#123; __(&apos;footer.powered&apos;, &apos;&lt;a class=&quot;theme-link&quot; target=&quot;_blank&quot; href=&quot;https://hexo.io&quot;&gt;Hexo&lt;/a&gt;&apos;) &#125;&#125;&#123;#</span><br><span class="line">#&#125;&lt;/div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% if theme.footer.powered and theme.footer.theme.enable %&#125;</span><br><span class="line">  &lt;span class=&quot;post-meta-divider&quot;&gt;|&lt;/span&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% if theme.footer.theme.enable %&#125;</span><br><span class="line">  &lt;div class=&quot;theme-info&quot;&gt;&#123;#</span><br><span class="line">  #&#125;&#123;&#123; __(&apos;footer.theme&apos;) &#125;&#125; &amp;mdash; &#123;#</span><br><span class="line">  #&#125;&lt;a class=&quot;theme-link&quot; target=&quot;_blank&quot; href=&quot;https://github.com/iissnan/hexo-theme-next&quot;&gt;&#123;#</span><br><span class="line">    #&#125;NexT.&#123;&#123; theme.scheme &#125;&#125;&#123;#</span><br><span class="line">  #&#125;&lt;/a&gt;&#123;% if theme.footer.theme.version %&#125; v&#123;&#123; theme.version &#125;&#125;&#123;% endif %&#125;&#123;#</span><br><span class="line">#&#125;&lt;/div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line"></span><br><span class="line">&#123;% if theme.footer.custom_text %&#125;</span><br><span class="line">  &lt;div class=&quot;footer-custom&quot;&gt;&#123;#</span><br><span class="line">  #&#125;&#123;&#123; theme.footer.custom_text &#125;&#125;&#123;#</span><br><span class="line">#&#125;&lt;/div&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">--&gt;</span><br></pre></td></tr></table></figure></li><li><p>博文置顶<br>修改<code>hexo-generator-index</code>插件，把<code>/node_modules/hexo-generator-index/lib/generator.js</code>中代码替换为：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&apos;use strict&apos;;</span><br><span class="line">var pagination = require(&apos;hexo-pagination&apos;);</span><br><span class="line">module.exports = function(locals)&#123;</span><br><span class="line">  var config = this.config;</span><br><span class="line">  var posts = locals.posts;</span><br><span class="line">    posts.data = posts.data.sort(function(a, b) &#123;</span><br><span class="line">        if(a.top &amp;&amp; b.top) &#123; // 两篇文章top都有定义</span><br><span class="line">            if(a.top == b.top) return b.date - a.date; // 若top值一样则按照文章日期降序排</span><br><span class="line">            else return b.top - a.top; // 否则按照top值降序排</span><br><span class="line">        &#125;</span><br><span class="line">        else if(a.top &amp;&amp; !b.top) &#123; // 以下是只有一篇文章top有定义，那么将有top的排在前面（这里用异或操作居然不行233）</span><br><span class="line">            return -1;</span><br><span class="line">        &#125;</span><br><span class="line">        else if(!a.top &amp;&amp; b.top) &#123;</span><br><span class="line">            return 1;</span><br><span class="line">        &#125;</span><br><span class="line">        else return b.date - a.date; // 都没定义按照文章日期降序排</span><br><span class="line">    &#125;);</span><br><span class="line">  var paginationDir = config.pagination_dir || &apos;page&apos;;</span><br><span class="line">  return pagination(&apos;&apos;, posts, &#123;</span><br><span class="line">    perPage: config.index_generator.per_page,</span><br><span class="line">    layout: [&apos;index&apos;, &apos;archive&apos;],</span><br><span class="line">    format: paginationDir + &apos;/%d/&apos;,</span><br><span class="line">    data: &#123;</span><br><span class="line">      __index: true</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ol><p>文章添加Top值，值越大，越靠前：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">---</span><br><span class="line">title: Hexo博客建站一〈基础搭建〉</span><br><span class="line">date: 2018-05-15 09:32:37</span><br><span class="line">comments: true #是否可评论</span><br><span class="line">toc: true #是否显示文章目录</span><br><span class="line">categories: &quot;个人博客&quot;</span><br><span class="line">tags: </span><br><span class="line">  - hexo</span><br><span class="line">top: 100</span><br><span class="line">---</span><br></pre></td></tr></table></figure></p><ol start="16"><li><p>网站字体大小<br>编辑<code>/themes/next/source/css/_variables/base.styl</code>，搜索<code>$font-size-base</code>，修改为你想要的大小:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// Font size</span><br><span class="line">$font-size-base           = 16px</span><br></pre></td></tr></table></figure></li><li><p>添加侧栏推荐阅读<br>编辑主题配置文件，如下配置即可：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Blog rolls</span><br><span class="line">links_icon: link</span><br><span class="line">links_title: 推荐阅读</span><br><span class="line">#links_layout: block</span><br><span class="line">links_layout: inline</span><br><span class="line">links:</span><br><span class="line">  Swift 4: https://developer.apple.com/swift/</span><br><span class="line">  Objective-C: https://developer.apple.com/documentation/objectivec</span><br></pre></td></tr></table></figure></li><li><p>站内搜索<br>NexT主题支持集成 Swiftype、微搜索、Local Search 和 Algolia。这里我们采用 Local Search。<br>(1) 安装 hexo-generator-search 和 hexo-generator-searchdb</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-search --save</span><br><span class="line">npm install hexo-generator-searchdb --save</span><br></pre></td></tr></table></figure></li></ol><p>(2) 编辑站点配置文件，添加以下内容:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># hexo-generator-searchdb</span><br><span class="line">search:</span><br><span class="line">  path: search.xml</span><br><span class="line">  field: post</span><br><span class="line">  format: html</span><br><span class="line">  limit: 10000</span><br></pre></td></tr></table></figure></p><p>(3) 编辑主题配置文件，设置Local searchenable为ture<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">local_search:</span><br><span class="line">  enable: true</span><br><span class="line">  # if auto, trigger search by changing input</span><br><span class="line">  # if manual, trigger search by pressing enter key or search button</span><br><span class="line">  trigger: auto</span><br><span class="line">  # show top n results per article, show all results by setting to -1</span><br><span class="line">  top_n_per_article: 1</span><br></pre></td></tr></table></figure></p><ol start="19"><li>修改底部标签样式<br>修改<code>\themes\next\layout\_macro\post.swig</code>中文件，搜索<code>rel=&quot;tag&quot;&gt;#</code>，将<code>#</code>替换成<code>&lt;i class=&quot;fa fa-tag&quot;&gt;&lt;/i&gt;</code>编译重启，可查看效果。</li><li>修改文章内链接文本样式<br>修改<code>/themes/next/source/css/_common/components/post/post.styl</code>，在末尾添加CSS样式，如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 文章内链接文本样式</span><br><span class="line">.post-body p a&#123;</span><br><span class="line">  color: #0593d3; //原始链接颜色</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  border-bottom: 1px solid #0593d3; //底部分割线颜色</span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    color: #fc6423; //鼠标经过颜色</span><br><span class="line">    border-bottom: none;</span><br><span class="line">    border-bottom: 1px solid #fc6423; //底部分割线颜色</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/hexo-678x381.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="个人博客" scheme="https://www.corkercode.com/categories/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://www.corkercode.com/tags/hexo/"/>
    
      <category term="next" scheme="https://www.corkercode.com/tags/next/"/>
    
  </entry>
  
  <entry>
    <title>Hexo博客建站三〈玄阶配置〉</title>
    <link href="https://www.corkercode.com/2018/07/14/Hexo%E5%8D%9A%E5%AE%A2%E5%BB%BA%E7%AB%99%E4%B8%89%E3%80%88%E7%8E%84%E9%98%B6%E9%85%8D%E7%BD%AE%E3%80%89/"/>
    <id>https://www.corkercode.com/2018/07/14/Hexo博客建站三〈玄阶配置〉/</id>
    <published>2018-07-14T05:33:37.000Z</published>
    <updated>2019-01-27T16:16:51.099Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/hexo-next.png" alt=""></div><a id="more"></a><blockquote><p>接上一篇<a href="">黄阶配置</a></p></blockquote><p>###玄阶配置<br>前面我们已经成功的执行以下步骤（以下步骤全部在主题配置文件中完成，除开有些标识的）：</p><ul><li><p>下载 Next 主题</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd your-hexo-site</span><br><span class="line">git clone https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure></li><li><p>启用主题<br>修改站点配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">theme: next</span><br></pre></td></tr></table></figure></li><li><p>验证主题</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br><span class="line">INFO  Hexo is running at http://0.0.0.0:4000/. Press Ctrl+C to stop.</span><br></pre></td></tr></table></figure></li></ul><p>此时即可使用浏览器访问 <a href="http://localhost:4000，检查站点是否正确运行。" target="_blank" rel="noopener">http://localhost:4000，检查站点是否正确运行。</a><br><strong>以下是我们即将要执行的操作：</strong></p><ol><li>选择 Scheme<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># Schemes</span><br><span class="line"># scheme: Muse</span><br><span class="line"># scheme: Mist</span><br><span class="line"># scheme: Pisces</span><br><span class="line">scheme: Gemini</span><br></pre></td></tr></table></figure></li></ol><p>这里我使用第五种，修改主题配置文件即可修改成功。</p><ol start="2"><li>设置菜单<br>菜单配置包括三个部分，第一是菜单项（名称和链接），第二是菜单项的显示文本，第三是菜单项对应的图标。 NexT 使用的是 <a href="http://fontawesome.io/" target="_blank" rel="noopener">Font Awesome</a> 提供的图标。</li></ol><ul><li><p>设定菜单名称和链接，如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: / || home</span><br><span class="line">  archives: /archives/ || archive</span><br><span class="line">  categories: /categories/ || th</span><br><span class="line">  tags: /tags/ || tags</span><br><span class="line">  about: /about/ || user</span><br><span class="line">  #schedule: /schedule/ || calendar</span><br><span class="line">  #sitemap: /sitemap.xml || sitemap</span><br><span class="line">  #commonweal: /404/ || heartbeat</span><br></pre></td></tr></table></figure></li><li><p>设定菜单项的显示文本<br>Next 默认显示的名称是菜单的的英文，如果要使用其他语言，就要修改主题文件下的<code>languages</code>文件夹下的对应语言的<code>yml</code>的配置文件。这里以简体中文为例（修改<code>zh-Hans.yml</code>）：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">  home: 首页</span><br><span class="line">  archives: 归档</span><br><span class="line">  categories: 分类</span><br><span class="line">  tags: 标签</span><br><span class="line">  about: 关于</span><br><span class="line">  search: 搜索</span><br><span class="line">  schedule: 日程表</span><br><span class="line">  sitemap: 站点地图</span><br><span class="line">  commonweal: 公益404</span><br></pre></td></tr></table></figure></li><li><p>设定菜单项对应的图标</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">menu_icons:</span><br><span class="line">  enable: true</span><br><span class="line">  # Icon Mapping.</span><br><span class="line">  home: home</span><br><span class="line">  about: user</span><br><span class="line">  categories: th</span><br><span class="line">  tags: tags</span><br><span class="line">  archives: archive</span><br><span class="line">  commonweal: heartbeat</span><br></pre></td></tr></table></figure></li></ul><p><strong>注：在菜单图标开启的情况下，如果菜单项与菜单未匹配（没有设置或者无效的 Font Awesome 图标名字） 的情况下，NexT 将会使用?作为图标。 | 请注意键值（如 home）的大小写要严格匹配。</strong></p><ol start="3"><li>设置左侧栏</li></ol><ul><li><p>设置侧栏的位置，修改 sidebar.position 的值，支持的选项有：<br><code>left - 靠左放置</code><br><code>right - 靠右放置</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sidebar:</span><br><span class="line">  position: left</span><br></pre></td></tr></table></figure></li><li><p>设置侧栏显示的时机，修改 sidebar.display 的值，支持的选项有：<br><code>post - 默认行为，在文章页面（拥有目录列表）时显示</code><br><code>always - 在所有页面中都显示</code><br><code>hide - 在所有页面中都隐藏（可以手动展开）</code><br><code>remove - 完全移除</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sidebar:</span><br><span class="line">  display: post</span><br></pre></td></tr></table></figure></li></ul><ol start="4"><li>头像设置<br>主要就是设置头像的路径地址，这里头像的地址可以由多种方式：</li></ol><table><thead><tr><th>地址</th><th>值</th></tr></thead><tbody><tr><td>完整的互联网 URI</td><td><a href="http://example.com/avatar.png" target="_blank" rel="noopener">http://example.com/avatar.png</a></td></tr><tr><td>站点内的地址</td><td>将头像放置主题目录下的 source/uploads/ （新建 uploads 目录若不存在） </td></tr></tbody></table><p>配置为：avatar: /uploads/avatar.png<br>或者 放置在 source/images/ 目录下<br>配置为：avatar: /images/avatar.png |<br>头像设置示例：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">avatar: http://example.com/avatar.png</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/hexo-next.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="个人博客" scheme="https://www.corkercode.com/categories/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://www.corkercode.com/tags/hexo/"/>
    
      <category term="next" scheme="https://www.corkercode.com/tags/next/"/>
    
  </entry>
  
  <entry>
    <title>Hexo博客建站二〈黄阶配置〉</title>
    <link href="https://www.corkercode.com/2018/07/14/Hexo%E5%8D%9A%E5%AE%A2%E5%BB%BA%E7%AB%99%E4%BA%8C%E3%80%88%E9%BB%84%E9%98%B6%E9%85%8D%E7%BD%AE%E3%80%89/"/>
    <id>https://www.corkercode.com/2018/07/14/Hexo博客建站二〈黄阶配置〉/</id>
    <published>2018-07-14T05:32:37.000Z</published>
    <updated>2019-01-27T16:14:52.440Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/hexo-github.png" alt=""></div><a id="more"></a><blockquote><p>至上篇搭建博客文章后，断更了后续，在此说声抱歉。<br>由于后面的配置篇在网上较为冗余，我把自己的配置过程做了详细记录，其中借鉴了些其他作者的思路，也感谢 <a href="">Hexo</a> 及 <a href="">Next</a> 给我们提供这么好的平台。<br>由于本篇幅较长，本着长时间查看不方便，还是分下篇，由天、地、玄、黄四篇配置组成，配置由高到低，博友们可选择配置自己的站点。<br>欢迎关注的我的公众号 <strong>zoluo</strong> 及博客 <a href="https://www.corkercode.com">zoluo</a>！<br><img src="http://upload-images.jianshu.io/upload_images/7269465-7d56394b38da709d.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="zoluo 个人公众号"></p></blockquote><blockquote><p>在上一篇文章 <a href="https://www.jianshu.com/p/a19cffead406" target="_blank" rel="noopener">Hexo博客建站一〈基础搭建〉</a> 我们已经在本地搭建好了博客的整体框架，接下来，我们应该把文章部署到外网可访问的位置，毕竟只是在本地玩玩就没意思了。</p></blockquote><p>###Hexo 部署到 GitHub Page<br>在上篇文章我们已经在 GitHub 上创建好了名为 <strong>username.github.io</strong> 的仓库，下载我们只需按照提示上传我们生成的静态代码到此仓库就行了。<br>在此先声明两点：</p><ul><li>站点配置文件<code>_config.yml</code>位于最外层文件夹下</li><li>主题配置文件<code>_config.yml</code>位于最外层文件夹/themes/next/_config.yml。</li></ul><ol><li><p>Hexo 配置 GitHub<br>在站点配置文件下，修改以下配置，如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># Deployment</span><br><span class="line">## Docs: https://hexo.io/docs/deployment.html</span><br><span class="line">deploy:</span><br><span class="line">  type: git</span><br><span class="line">  repository: git@github.com:zoluoc/zoluoc.github.io.git</span><br><span class="line">  branch: master</span><br></pre></td></tr></table></figure></li><li><p>SSH配置<br><code>ssh</code>配置主要是上传代码时<code>hexo d</code>免输用户名和密码，因此有必要配置以下。<br>(1) 首先打开命令行工具，通常我们可以直接右键鼠标任意位置打开 Git Bash Here，然后输入以下命令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~/.ssh</span><br><span class="line"># Checks to see if there is a directory named &quot;.ssh&quot; in your user directory</span><br></pre></td></tr></table></figure></li></ol><p>(2) 使用 ssh-keygen 生成密钥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</span><br><span class="line"># Creates a new ssh key using the provided email</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/home/you/.ssh/id_rsa):</span><br></pre></td></tr></table></figure></p><p>简化流程的话在键入命令<code>ssh-keygen -t rsa -C &quot;your_email@example.com&quot;</code>以后的三次提示输入都可以直接回车跳过。<br>密钥生成成功,如：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Your identification has been saved in /home/you/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /home/you/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">…………………此处是密钥内容…………………… your_email@example.com</span><br></pre></td></tr></table></figure></p><p>(3) 设置此仓库的 SSH keys<br>按下图找到 GitHub 设置 SSH 的位置<br><img src="http://upload-images.jianshu.io/upload_images/7269465-2322d31d67a45f40.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="hexo ssh"><br>然后将生成的 id_rsa.pub 中的内容全选复制到 key 输入框中，然后点击 Add key 完成添加公钥。<br><img src="http://upload-images.jianshu.io/upload_images/7269465-d932288ff342f02f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="hexo add keys"><br>(4) 测试配置是否成功<br>如果出现以下内容即表示配置完成并且成功！<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh -T git@github.com</span><br><span class="line">Hi username! You&apos;ve successfully authenticated, but GitHub does not</span><br><span class="line">provide shell access.</span><br></pre></td></tr></table></figure></p><p><strong>这个时候我们再使用<code>hexo d</code>就能上传代码到服务器了！</strong></p><p>####上传代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo d</span><br></pre></td></tr></table></figure></p><p>到 GitHub 仓库可以看到我们的代码已经上传成功。<br>最后我们访问 <code>https://username.github.io</code> 就可以访问到我们的站点了，是不是很<strong>6</strong>，这不算啥，接下来我们让网站变的更炫酷！</p><p>###黄阶配置<br>以下配置都是修改站点配置文件<code>_config.yml</code>来完成的，参考 <a href="https://hexo.io/zh-cn/docs/configuration" target="_blank" rel="noopener">Hexo 官网</a></p><ol><li>网站</li></ol><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>title</td><td>网站标题</td></tr><tr><td>subtitle</td><td>网站副标题</td></tr><tr><td>description</td><td>网站描述</td></tr><tr><td>author</td><td>您的名字</td></tr><tr><td>language</td><td>网站使用的语言，中文使用<code>zh-Hans</code></td></tr><tr><td>timezone</td><td>网站时区。Hexo 默认使用您电脑的时区，可不填。时区列表。比如说：America/New_York, Japan, 和 UTC</td></tr></tbody></table><ol start="2"><li>网址</li></ol><table><thead><tr><th>参数</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td>url</td><td>网址</td><td></td></tr><tr><td>root</td><td>网站根目录</td><td>/</td></tr><tr><td>permalink</td><td>文章的永久链接格式</td><td>:year/:month/:day/:title/</td></tr><tr><td>permalink_defaults</td><td>永久链接中各部分的默认值</td></tr></tbody></table><p><strong>注：这里根目录的设置其实就是把网站放入到子目录，如：将根目录修改成<code>/blog/</code>，则 URL 后</strong>须<strong>加上<code>/blog</code>。</strong></p><ol start="3"><li>目录</li></ol><table><thead><tr><th>参数</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td>source_dir</td><td>资源文件夹，这个文件夹用来存放内容</td><td>source</td></tr><tr><td>public_dir</td><td>公共文件夹，这个文件夹用于存放生成的站点文件。</td><td>public</td></tr><tr><td>tag_dir</td><td>标签文件夹</td><td>tags</td></tr><tr><td>archive_dir</td><td>归档文件夹</td><td>archives</td></tr><tr><td>category_dir</td><td>分类文件夹</td><td>categories</td></tr><tr><td>code_dir</td><td>Include code 文件夹</td><td>downloads/code</td></tr><tr><td>i18n_dir</td><td>国际化（i18n）文件夹</td><td>:lang</td></tr><tr><td>skip_render</td><td>跳过指定文件的渲染，您可使用 glob 表达式来匹配路径</td><td>source</td></tr></tbody></table><p><strong>注：如果您刚刚开始接触Hexo，通常没有必要修改这一部分的值，到需要时可后续来修改。</strong></p><ol start="4"><li>文章</li></ol><table><thead><tr><th>参数</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td>new_post_name</td><td>新文章的文件名称</td><td>:title.md</td></tr><tr><td>default_layout</td><td>预设布局</td><td>post</td></tr><tr><td>auto_spacing</td><td>在中文和英文之间加入空格</td><td>false</td></tr><tr><td>titlecase</td><td>把标题转换为 title case</td><td>false</td></tr><tr><td>external_link</td><td>在新标签中打开链接</td><td>true</td></tr><tr><td>filename_case</td><td>把文件名称转换为 (1) 小写或 (2) 大写</td><td>0</td></tr><tr><td>render_drafts</td><td>显示草稿</td><td>false</td></tr><tr><td>post_asset_folder</td><td>启动 Asset 文件夹</td><td>false</td></tr><tr><td>relative_link</td><td>把链接改为与根目录的相对位址</td><td>false</td></tr><tr><td>future</td><td>显示未来的文章</td><td>true</td></tr><tr><td>highlight</td><td>代码块的设置</td></tr></tbody></table><ol start="5"><li>分类 &amp; 标签</li></ol><table><thead><tr><th>参数</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td>default_category</td><td>默认分类</td><td>uncategorized</td></tr><tr><td>category_map</td><td>分类别名</td><td></td></tr><tr><td>tag_map</td><td>标签别名</td></tr></tbody></table><ol start="6"><li>日期 / 时间格式<br>Hexo 使用 <a href="http://momentjs.com/" target="_blank" rel="noopener">Moment.js</a> 来解析和显示时间。</li></ol><table><thead><tr><th>参数</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td>date_format</td><td>日期格式</td><td>YYYY-MM-DD</td></tr><tr><td>time_format</td><td>时间格式</td><td>H:mm:ss</td></tr></tbody></table><ol start="7"><li>分页</li></ol><table><thead><tr><th>参数</th><th>描述</th><th>默认值</th></tr></thead><tbody><tr><td>per_page</td><td>每页显示的文章量 (0 = 关闭分页功能)</td><td>10</td></tr><tr><td>pagination_dir</td><td>分页目录</td><td>page</td></tr></tbody></table><ol start="8"><li>扩展</li></ol><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>theme</td><td>当前主题名称。值为false时禁用主题</td></tr><tr><td>deploy</td><td>部署部分的设置</td></tr></tbody></table><ol start="9"><li>创建 Menu 菜单<br>这里主题默认只有两个菜单：首页和归档，因此我们得创建自己的菜单，一下是创建方法：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo new page &quot;tags&quot;</span><br><span class="line">hexo new page &quot;categories&quot;</span><br><span class="line">hexo new page &quot;about&quot;</span><br></pre></td></tr></table></figure></li></ol>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/hexo-github.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="个人博客" scheme="https://www.corkercode.com/categories/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://www.corkercode.com/tags/hexo/"/>
    
      <category term="next" scheme="https://www.corkercode.com/tags/next/"/>
    
  </entry>
  
  <entry>
    <title>Hexo博客建站一〈基础搭建〉</title>
    <link href="https://www.corkercode.com/2018/05/15/Hexo%E5%8D%9A%E5%AE%A2%E5%BB%BA%E7%AB%99%E4%B8%80%E3%80%88%E5%9F%BA%E7%A1%80%E6%90%AD%E5%BB%BA%E3%80%89/"/>
    <id>https://www.corkercode.com/2018/05/15/Hexo博客建站一〈基础搭建〉/</id>
    <published>2018-05-15T01:32:37.000Z</published>
    <updated>2019-01-27T16:16:34.892Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/hexo_github.png" alt=""></div><a id="more"></a><blockquote><p>搭建个人博客前面提到了有很多种，我采用的是 Hexo 静态博客，Next 主题。<br>在这里 Hexo Next 就不做详细介绍了，官网地址戳这里 <a href="https://hexo.io/zh-cn/" target="_blank" rel="noopener">Hexo</a> <a href="http://theme-next.iissnan.com/" target="_blank" rel="noopener">Next</a><br>官方网站对安装与配置进行了详细的介绍，包括站点配置主题配置，<br>后面我针对需要的部分进行配置与说明。<br>下面是我搭建的详细过程。</p></blockquote><h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><ol><li><p>电脑以及拥有可用的系统，可上网，Windows、Linux、Mac Os 都可以</p></li><li><p>Git客户端安装<br><a href="https://git-scm.com/downloads" target="_blank" rel="noopener">Git 客户端下载</a><br><img src="https://upload-images.jianshu.io/upload_images/7269465-75b2ecb6f918c1ea.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>点击安装，安装完成如下图<br><img src="https://upload-images.jianshu.io/upload_images/7269465-4c8c9c0964cc11c0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p></li><li><p>Node.js安装</p></li></ol><p><a href="https://nodejs.org/en/" target="_blank" rel="noopener">Node 下载</a><br><img src="https://upload-images.jianshu.io/upload_images/7269465-05cab7f82dc2b7c6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>点击安装，安装完成如下图<br><img src="https://upload-images.jianshu.io/upload_images/7269465-7aa2192f9969a621.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p><ol start="4"><li>远程代码仓库 Github、Coding都行，这里我选择Github</li></ol><p><img src="https://upload-images.jianshu.io/upload_images/7269465-45f4a43b9a2215ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>这里需注意仓库名必须是 <strong>username.github.io</strong></p><ol start="5"><li>可解析域名准备一个，暂时没有的可不用，我自己买了一个国际域名 <strong>corkercode.com</strong></li></ol><p><img src="https://upload-images.jianshu.io/upload_images/7269465-d0b59af24cb3bfec.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p><h3 id="开始安装"><a href="#开始安装" class="headerlink" title="开始安装"></a>开始安装</h3><h4 id="hexo安装"><a href="#hexo安装" class="headerlink" title="hexo安装"></a>hexo安装</h4><p>官网上已经有详细的安装说明了，这里记录下关键必须的步骤。<br>当以上所有必备的应用程序安装完成后，即可使用 npm 安装 Hexo，以下所有步骤都在自己建的目录下进行。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo --save</span><br></pre></td></tr></table></figure></p><p>安装 Hexo 完成后，请执行下列命令，Hexo 将会在指定文件夹中新建所需要的文件。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo init</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></p><p>新建完成后，指定文件夹的目录如下：<br><img src="https://upload-images.jianshu.io/upload_images/7269465-2d46b6e15adf02a6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>这个时候你运行以下命令就可以看到博客框架已搭建起来了访问 <a href="https://http:localhost:4000/" target="_blank" rel="noopener">博客主页</a>。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure></p><p><img src="https://upload-images.jianshu.io/upload_images/7269465-0952d5af9679df95.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p><h4 id="next安装"><a href="#next安装" class="headerlink" title="next安装"></a>next安装</h4><p>可以看到上面博客主题不是自己喜欢的样子，别着急，github上给我提供了很多主题样式，地址在这里，自己选择，配置大同小异，我选用next。<br>在终端窗口下，定位到 Hexo 站点目录下。使用 Git checkout 代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/iissnan/hexo-theme-next themes/next</span><br></pre></td></tr></table></figure></p><p>这时在本地终端上Ctrl+c，结束正在运行的进程，并修改站点配置文件主题为next<br>重新执行上面的命令，可以看到成功的切换到了我们喜欢的主题了。<br><img src="https://upload-images.jianshu.io/upload_images/7269465-e954056c8d552acb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>但是和别人的主题比起来还是有一些逊色，不着急，这些都是可以一步一步的配置的，不过我这里注重原创内容创造，对内容上面的配置会更加注重，后面我也会尽量添加一些样式的配置，大家可参考参考。</p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/hexo_github.png&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="个人博客" scheme="https://www.corkercode.com/categories/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://www.corkercode.com/tags/hexo/"/>
    
      <category term="next" scheme="https://www.corkercode.com/tags/next/"/>
    
  </entry>
  
  <entry>
    <title>个人博客</title>
    <link href="https://www.corkercode.com/2018/05/14/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    <id>https://www.corkercode.com/2018/05/14/个人博客/</id>
    <published>2018-05-14T09:32:37.000Z</published>
    <updated>2019-01-27T16:15:48.709Z</updated>
    
    <content type="html"><![CDATA[<div style="width: 500px; margin: auto"><img src="http://plbhkv0pr.bkt.clouddn.com/think.jpg" alt=""></div><a id="more"></a><h2 id="搭建个人博客的想法"><a href="#搭建个人博客的想法" class="headerlink" title="搭建个人博客的想法"></a>搭建个人博客的想法</h2><p>作为一个程序员时不时会看到和想到一些好的文章和观点，有时候还有些漂亮的代码段，想记录下来的方式很多，以前本人使用印象笔记来记录点滴。直到2017年初有了建立博客的想法，最开始自己想使用 Java web 来开发一个 Blog 以及后台管理，v1.0.0 版本也发布出来了，但是个人感觉丑死了，后台使用包 Bootstrap 还好一些，而且没有评论和计数的功能，所以就放弃使用了。后来在网上找了一些第三方的静态 Blog 搭建的方案，最后还是确定使用 Hexo 静态博客和 Next 主题来搭建。</p><!-- more --><h2 id="搭建博客的方式"><a href="#搭建博客的方式" class="headerlink" title="搭建博客的方式"></a>搭建博客的方式</h2><p>搭建博客的方式有很多种，网上也有很多实例如 Wordpress、Z-blog等，我看了几种感觉都感觉不是很合适，最后看到的 Hexo 搭配 GitHub Pages搭建静态博客网站感觉还是挺好的，有很多主题可自己选择，还有很多插件也可以安装，所以就选择了这种方式来搭建我的个人博客。<br>由于搭建博客的过程听起来简单但还是对于一些新人或非程序员来说还是有些不便，后面我会出一个系列文章来指导大家——如何搭建出优美的个人博客。</p><h2 id="搭建博客的目的"><a href="#搭建博客的目的" class="headerlink" title="搭建博客的目的"></a>搭建博客的目的</h2><p>时间不等人，知识学了会忘，blog 不仅可以记录你生活的点滴还能帮助你成长，能让别人来见证你的过程，还能帮助别人解决困难……所以我决定开始属于自己的 Blog。<br>后面我会不定时的更新博客内容，诚邀大家一起指点记录 <a href="https://www.corkercode.com">zoluo</a>.</p>]]></content>
    
    <summary type="html">
    
      &lt;div style=&quot;width: 500px; margin: auto&quot;&gt;&lt;img src=&quot;http://plbhkv0pr.bkt.clouddn.com/think.jpg&quot; alt=&quot;&quot;&gt;&lt;/div&gt;
    
    </summary>
    
      <category term="个人博客" scheme="https://www.corkercode.com/categories/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/"/>
    
    
      <category term="hexo" scheme="https://www.corkercode.com/tags/hexo/"/>
    
      <category term="next" scheme="https://www.corkercode.com/tags/next/"/>
    
  </entry>
  
</feed>
